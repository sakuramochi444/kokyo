<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公共・政治経済 ノート完全攻略（修正版）</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        /* スクロールバーのカスタマイズ */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 h-screen overflow-hidden">
    <div id="root" class="h-full"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- 全185問の問題データ ---
        const quizDatabase = [
            // --- 第1編 第3章 人間の尊厳 (P1) ---
            { category: "1. 人間の尊厳と平等 (P1)", question: "自分にとって望ましい死のあり方を、判断能力があるうちに文書などで生前に意思表明しておくことを何といいますか？", answer: "リビング・ウィル", options: ["リビング・ウィル", "インフォームド・コンセント", "パターナリズム", "ホスピス"], note: "P.1 尊厳死宣言ともいう" },
            { category: "1. 人間の尊厳と平等 (P1)", question: "生命の尊厳をアルファベット3文字で何といいますか？", answer: "SOL", options: ["SOL", "QOL", "ADL", "WHO"], note: "P.1 Sanctity of Life" },
            { category: "1. 人間の尊厳と平等 (P1)", question: "みずからの意思により、延命治療の停止を希望し、自然な死を選択することを何といいますか？", answer: "尊厳死", options: ["尊厳死", "安楽死", "脳死", "平穏死"], note: "P.1" },
            { category: "1. 人間の尊厳と平等 (P1)", question: "本人の意思や家族の同意の下、薬物などの人為的な手段によって死期を早めることを何といいますか？（オランダなどで合法化）", answer: "安楽死", options: ["安楽死", "尊厳死", "自然死", "自殺幇助"], note: "P.1" },
            { category: "1. 人間の尊厳と平等 (P1)", question: "多数派に対して、社会的・数的に弱い立場にある「少数派」を何といいますか？", answer: "マイノリティ", options: ["マイノリティ", "マジョリティ", "コミュニティ", "アイデンティティ"], note: "P.1" },
            { category: "1. 人間の尊厳と平等 (P1)", question: "『第二の性』で「人は女に生まれるのではない、女になるのだ」と述べた思想家は誰ですか？", answer: "ボーヴォワール", options: ["ボーヴォワール", "サルトル", "アレント", "ナイチンゲール"], note: "P.1" },
            { category: "1. 人間の尊厳と平等 (P1)", question: "社会に参加し、人類全体への責任を負いつつ社会変革に関わることを、サルトルは何と呼びましたか？", answer: "アンガージュマン", options: ["アンガージュマン", "イニシエーション", "パラダイム", "モラトリアム"], note: "P.1" },
            { category: "1. 人間の尊厳と平等 (P1)", question: "「憎しみには愛をもってこたえなければならない」と説き、非暴力・不服従を貫いた人物は誰ですか？", answer: "キング牧師", options: ["キング牧師", "ガンディー", "マンデラ", "マルコムX"], note: "P.1" },
            { category: "1. 人間の尊厳と平等 (P1)", question: "1999年に制定された、男女が互いに人権を尊重しつつ責任を分かち合う社会を目指す法律は何ですか？", answer: "男女共同参画社会基本法", options: ["男女共同参画社会基本法", "男女雇用機会均等法", "女性活躍推進法", "育児・介護休業法"], note: "P.2" },
            { category: "1. 人間の尊厳と平等 (P1)", question: "実質的な機会均等を目指し、差別されてきたグループに対して暫定的に優遇措置をとることを何といいますか？", answer: "ポジティブ・アクション", options: ["ポジティブ・アクション", "ノーマライゼーション", "セーフティネット", "ワーク・ライフ・バランス"], note: "P.2 別名：アファーマティブ・アクション" },
            { category: "1. 人間の尊厳と平等 (P1)", question: "2015年に制定され、企業に女性の管理職登用などの数値目標設定を求めた法律は何ですか？", answer: "女性活躍推進法", options: ["女性活躍推進法", "男女雇用機会均等法", "政治分野における男女共同参画推進法", "パートタイム労働法"], note: "P.2" },
            { category: "1. 人間の尊厳と平等 (P1)", question: "2018年に制定された、選挙での男女の候補者数の均等を目指す法律は何ですか？", answer: "候補者男女均等法", options: ["候補者男女均等法", "公職選挙法", "政党助成法", "女性活躍推進法"], note: "P.2 正式名称：政治分野における男女共同参画推進法" },
            { category: "1. 人間の尊厳と平等 (P1)", question: "「男は仕事、女は家庭」といった、社会的・文化的に作られた性別による役割分担を何といいますか？", answer: "性別役割分担", options: ["性別役割分担", "ジェンダー・ギャップ", "ガラスの天井", "マミー・トラック"], note: "P.2" },

            // --- 第1編 第3章 個人の尊重 (P3) ---
            { category: "2. 人権の歴史と国際社会 (P3)", question: "1215年、イギリスの貴族が王権を制限させた文書は何ですか？", answer: "マグナ・カルタ", options: ["マグナ・カルタ", "権利請願", "権利章典", "人身保護法"], note: "P.3 大憲章" },
            { category: "2. 人権の歴史と国際社会 (P3)", question: "1628年、イギリス議会がチャールズ1世に提出した文書は何ですか？", answer: "権利請願", options: ["権利請願", "権利章典", "マグナ・カルタ", "独立宣言"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会 (P3)", question: "1689年、名誉革命の結果として制定された文書は何ですか？", answer: "権利章典", options: ["権利章典", "権利請願", "人権宣言", "バージニア権利章典"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会 (P3)", question: "1776年、基本的人権を定めた世界初の成文憲法といわれるアメリカの文書は何ですか？", answer: "バージニア権利章典", options: ["バージニア権利章典", "アメリカ独立宣言", "フランス人権宣言", "マサチューセッツ憲法"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会 (P3)", question: "1776年のアメリカ独立宣言で、「天から与えられた」と表現された人権概念は何ですか？", answer: "天賦人権", options: ["天賦人権", "自然権", "社会権", "抵抗権"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会 (P3)", question: "1789年のフランス人権宣言で、自由・所有権などとともに「自然権」として保障されたのは何ですか？", answer: "圧制への抵抗", options: ["圧制への抵抗", "幸福追求権", "環境権", "プライバシー権"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会 (P3)", question: "国家からの自由（自由権）に対し、人間らしい生活を求める権利を何といいますか？（20世紀的人権）", answer: "社会権", options: ["社会権", "参政権", "請求権", "平等権"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会 (P3)", question: "1919年に制定され、世界で初めて社会権を保障した憲法は何ですか？", answer: "ワイマール憲法", options: ["ワイマール憲法", "フランス憲法", "日本国憲法", "ソビエト憲法"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会 (P3)", question: "1948年に国連で採択された、世界共通の人権基準を示した宣言は何ですか？（法的拘束力なし）", answer: "世界人権宣言", options: ["世界人権宣言", "国際人権規約", "児童の権利条約", "人種差別撤廃条約"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会 (P3)", question: "1966年に採択され、世界人権宣言を条約化して法的拘束力を持たせたものは何ですか？", answer: "国際人権規約", options: ["国際人権規約", "ウィーン条約", "パリ協定", "ハーグ条約"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会 (P3)", question: "国連人権理事会（UNHRC）などが中心となって進めているのは何ですか？", answer: "国際的な人権保障", options: ["国際的な人権保障", "国際的な経済協力", "国際的な軍事同盟", "国際的な環境保護"], note: "P.3" },

            // --- 第1編 第3章 民主政治の原理 (P4) ---
            { category: "3. 民主政治の原理 (P4)", question: "国王の権力は神から与えられたとする説を何といいますか？", answer: "王権神授説", options: ["王権神授説", "社会契約説", "法治主義", "立憲主義"], note: "P.4" },
            { category: "3. 民主政治の原理 (P4)", question: "人々が契約を結んで国家を作ったとする考え方を何といいますか？", answer: "社会契約説", options: ["社会契約説", "王権神授説", "自然法思想", "功利主義"], note: "P.4" },
            { category: "3. 民主政治の原理 (P4)", question: "『リバイアサン』で、自然状態を「万人の万人に対する闘争」と説いた人物は？", answer: "ホッブズ", options: ["ホッブズ", "ロック", "ルソー", "モンテスキュー"], note: "P.4" },
            { category: "3. 民主政治の原理 (P4)", question: "『市民政府二論』で、抵抗権（革命権）を認めた人物は？", answer: "ロック", options: ["ロック", "ホッブズ", "ルソー", "カント"], note: "P.4" },
            { category: "3. 民主政治の原理 (P4)", question: "『社会契約論』で、一般意思に基づく人民主権を説いた人物は？", answer: "ルソー", options: ["ルソー", "ロック", "ホッブズ", "ヘーゲル"], note: "P.4" },
            { category: "3. 民主政治の原理 (P4)", question: "国家の役割を治安維持などに限定する国家観（小さな政府）を何といいますか？", answer: "夜警国家", options: ["夜警国家", "福祉国家", "警察国家", "全体主義国家"], note: "P.4" },
            { category: "3. 民主政治の原理 (P4)", question: "国民の生活を幅広く保障する国家観（大きな政府）を何といいますか？", answer: "福祉国家", options: ["福祉国家", "夜警国家", "行政国家", "立法国家"], note: "P.4" },
            { category: "3. 民主政治の原理 (P4)", question: "普通選挙制のもとで、大衆が政治に参加する民主主義を何といいますか？", answer: "大衆民主主義", options: ["大衆民主主義", "制限民主主義", "エリート民主主義", "草の根民主主義"], note: "P.4" },
            { category: "3. 民主政治の原理 (P4)", question: "国家のあり方を最終的に決める権力が国民にあることを何といいますか？", answer: "国民主権", options: ["国民主権", "君主主権", "国家主権", "議会主権"], note: "P.4" },
            { category: "3. 民主政治の原理 (P4)", question: "国民全員が直接政治に参加する制度を何といいますか？", answer: "直接民主制", options: ["直接民主制", "間接民主制", "代表民主制", "議会制"], note: "P.4" },
            { category: "3. 民主政治の原理 (P4)", question: "国民が選んだ代表者が政治を行う制度を何といいますか？", answer: "間接民主制", options: ["間接民主制", "直接民主制", "国民投票制", "住民投票制"], note: "P.5" },
            { category: "3. 民主政治の原理 (P4)", question: "議会は一部の選挙民ではなく国民全体を代表するという原理を何といいますか？", answer: "国民代表の原理", options: ["国民代表の原理", "審議の原理", "監督の原理", "多数決の原理"], note: "P.5" },
            { category: "3. 民主政治の原理 (P4)", question: "議会は公開の場で討論を行わなければならないという原理を何といいますか？", answer: "審議の原理", options: ["審議の原理", "国民代表の原理", "監督の原理", "公開の原理"], note: "P.5" },

            // --- 第1編 第3章 法の支配 (P6) ---
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "権力者の恣意的な支配を排し、権力も法に拘束されるという考え方を何といいますか？", answer: "法の支配", options: ["法の支配", "法治主義", "人治主義", "専制主義"], note: "P.6" },
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "「王は何人の下にもあるべきではない。しかし神と法の下にあるべきである」と述べたイギリスの裁判官は？", answer: "エドワード・コーク", options: ["エドワード・コーク", "ブラクトン", "ダイシー", "ブラックストン"], note: "P.6" },
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "ドイツで発達した、行政が法律に基づいているかという形式を重視する考え方を何といいますか？", answer: "法治主義", options: ["法治主義", "法の支配", "立憲主義", "民主主義"], note: "P.6" },
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "権力の濫用を防ぐため、権力を分散させて抑制と均衡を図る仕組みを何といいますか？", answer: "権力分立", options: ["権力分立", "国民主権", "中央集権", "地方自治"], note: "P.6" },
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "立法権・執行権・連合権の分立を唱えたのは誰ですか？", answer: "ロック", options: ["ロック", "モンテスキュー", "ホッブズ", "ルソー"], note: "P.6" },
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "『法の精神』で、立法・行政・司法の三権分立を唱えたのは誰ですか？", answer: "モンテスキュー", options: ["モンテスキュー", "ロック", "ルソー", "カント"], note: "P.6" },
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "憲法によって国家権力を制限し、国民の人権を守るという思想を何といいますか？", answer: "立憲主義", options: ["立憲主義", "民主主義", "法治主義", "自由主義"], note: "P.6" },

            // --- 第1編 第3章 政治体制 (P8) ---
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "議会と内閣が密接に関係し、内閣が議会の信任に基づいて存立する制度を何といいますか？", answer: "議院内閣制", options: ["議院内閣制", "大統領制", "半大統領制", "権力集中制"], note: "P.8" },
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "イギリスで、野党が政権交代に備えて組織する模擬内閣を何といいますか？", answer: "影の内閣", options: ["影の内閣", "連立内閣", "暫定内閣", "挙国一致内閣"], note: "P.8 シャドー・キャビネット" },
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "アメリカ大統領が議会に対して持つ、法案を拒否する権限を何といいますか？", answer: "拒否権", options: ["拒否権", "解散権", "法案提出権", "弾劾権"], note: "P.8" },
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "アメリカ大統領が議会に対して政策などを勧告するために送るものを何といいますか？", answer: "教書", options: ["教書", "勅語", "法案", "決議案"], note: "P.8 教書送付権" },
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "フランスのように、大統領と首相が並存する体制を何といいますか？", answer: "半大統領制", options: ["半大統領制", "議院内閣制", "大統領制", "専制君主制"], note: "P.8" },
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "中国のように、共産党などの特定政党や機関に権力が集中する体制を何といいますか？", answer: "権力集中制", options: ["権力集中制", "権力分立制", "立憲主義", "自由主義"], note: "P.8 民主集中制" },
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "中国の国会に相当する機関を何といいますか？", answer: "全国人民代表大会", options: ["全国人民代表大会", "連邦議会", "国務院", "最高人民法院"], note: "P.8 全人代" },
            { category: "4. 法の支配と政治体制 (P6, P8)", question: "開発途上国で見られた、経済開発を優先して独裁を行う体制を何といいますか？", answer: "開発独裁", options: ["開発独裁", "軍事政権", "ファシズム", "ポピュリズム"], note: "P.8" },

            // --- 第1編 第3章 日本国憲法 (P9) ---
            { category: "5. 日本国憲法の基本 (P9)", question: "大日本帝国憲法のように、君主が定めた憲法を何といいますか？", answer: "欽定憲法", options: ["欽定憲法", "民定憲法", "協約憲法", "不文憲法"], note: "P.9" },
            { category: "5. 日本国憲法の基本 (P9)", question: "大日本帝国憲法で見られた、立憲主義の形式をとりつつ実質は絶対主義的な体制を何といいますか？", answer: "外見的立憲主義", options: ["外見的立憲主義", "真正立憲主義", "絶対君主制", "専制政治"], note: "P.9" },
            { category: "5. 日本国憲法の基本 (P9)", question: "大日本帝国憲法下で、天皇が軍隊を指揮監督する権限を何といいますか？", answer: "統帥権", options: ["統帥権", "統治権", "立法権", "編成権"], note: "P.9" },
            { category: "5. 日本国憲法の基本 (P9)", question: "大日本帝国憲法下で、国務大臣が天皇を助けることを何といいますか？", answer: "輔弼", options: ["輔弼", "補佐", "代行", "助言"], note: "P.9" },
            { category: "5. 日本国憲法の基本 (P9)", question: "日本が受諾し、憲法改正のきっかけとなった宣言は何ですか？", answer: "ポツダム宣言", options: ["ポツダム宣言", "カイロ宣言", "サンフランシスコ平和条約", "大西洋憲章"], note: "P.9" },
            { category: "5. 日本国憲法の基本 (P9)", question: "GHQが日本政府案を拒否して提示した憲法草案を何といいますか？", answer: "マッカーサー草案", options: ["マッカーサー草案", "松本案", "憲法研究会案", "吉田ドクトリン"], note: "P.9" },
            { category: "5. 日本国憲法の基本 (P9)", question: "日本国憲法の三大基本原理は、基本的人権の尊重、平和主義と何ですか？", answer: "国民主権", options: ["国民主権", "天皇主権", "国家主権", "議会主権"], note: "P.9" },
            { category: "5. 日本国憲法の基本 (P9)", question: "日本国憲法において、天皇の地位は何と規定されていますか？", answer: "象徴", options: ["象徴", "元首", "主権者", "統治者"], note: "P.9" },
            { category: "5. 日本国憲法の基本 (P9)", question: "天皇が行う、政治的権限を持たない行為を何といいますか？", answer: "国事行為", options: ["国事行為", "公的行為", "私的行為", "統治行為"], note: "P.9" },
            { category: "5. 日本国憲法の基本 (P9)", question: "国事行為を行う際に必要なものは、内閣の何と承認ですか？", answer: "助言", options: ["助言", "同意", "許可", "命令"], note: "P.9" },
            { category: "5. 日本国憲法の基本 (P9)", question: "憲法改正の発議に必要なのは、各議院の総議員のどれだけの賛成ですか？", answer: "3分の2以上", options: ["3分の2以上", "過半数", "3分の1以上", "4分の3以上"], note: "P.10" },
            { category: "5. 日本国憲法の基本 (P9)", question: "憲法改正の承認に必要なのは、国民投票でのどれだけの賛成ですか？", answer: "過半数", options: ["過半数", "3分の2以上", "3分の1以上", "全員"], note: "P.10" },
            { category: "5. 日本国憲法の基本 (P9)", question: "日本国憲法のように、改正手続きが法律よりも厳しい憲法を何といいますか？", answer: "硬性憲法", options: ["硬性憲法", "軟性憲法", "不文憲法", "成文憲法"], note: "P.10" },
            { category: "5. 日本国憲法の基本 (P9)", question: "憲法が国の最上位の法であることを何といいますか？", answer: "最高法規", options: ["最高法規", "基本法", "一般法", "特別法"], note: "P.10" },

            // --- 第2編 第1章 私たちの生活と法 (P22) ---
            { category: "6. 法の機能と種類 (P22)", question: "社会の秩序を維持するためのルールを総称して何といいますか？", answer: "社会規範", options: ["社会規範", "法", "道徳", "慣習"], note: "P.22" },
            { category: "6. 法の機能と種類 (P22)", question: "人間の理性に基づき、時代や場所を超えて通用する法を何といいますか？", answer: "自然法", options: ["自然法", "実定法", "制定法", "慣習法"], note: "P.22" },
            { category: "6. 法の機能と種類 (P22)", question: "一定の手続きを経て人為的に作られた法を何といいますか？", answer: "実定法", options: ["実定法", "自然法", "道徳法", "宗教法"], note: "P.22" },
            { category: "6. 法の機能と種類 (P22)", question: "法の内容を評価する基準として、目的達成のために適切かどうかを何といいますか？", answer: "手段の相当性", options: ["手段の相当性", "明確性", "公正性", "効率性"], note: "P.22" },
            { category: "6. 法の機能と種類 (P22)", question: "基本的人権は、憲法で「侵すことのできない◯◯の権利」とされています。", answer: "永久", options: ["永久", "絶対", "神聖", "固有"], note: "P.22" },
            { category: "6. 法の機能と種類 (P22)", question: "国家と国民の関係を規定した法（憲法や刑法など）を何といいますか？", answer: "公法", options: ["公法", "私法", "社会法", "国際法"], note: "P.22" },
            { category: "6. 法の機能と種類 (P22)", question: "私人間の関係を規定した法（民法や商法など）を何といいますか？", answer: "私法", options: ["私法", "公法", "社会法", "手続法"], note: "P.22" },
            { category: "6. 法の機能と種類 (P22)", question: "私人間では、契約などを自由に決められるという原則を何といいますか？", answer: "私的自治の原則", options: ["私的自治の原則", "契約自由の原則", "過失責任の原則", "罪刑法定主義"], note: "P.22" },
            { category: "6. 法の機能と種類 (P22)", question: "三菱樹脂訴訟で最高裁が採用した、憲法の人権規定は私人間には直接適用されないとする説は？", answer: "間接適用説", options: ["間接適用説", "直接適用説", "無効説", "適用除外説"], note: "P.22" },
            { category: "6. 法の機能と種類 (P22)", question: "労働法や社会保障法のように、私法的な分野に国家が介入する法を何といいますか？", answer: "社会法", options: ["社会法", "公法", "私法", "自然法"], note: "P.22" },
            { category: "6. 法の機能と種類 (P22)", question: "犯罪と刑罰はあらかじめ法律で定めなければならないという原則を何といいますか？", answer: "罪刑法定主義", options: ["罪刑法定主義", "法の支配", "一事不再理", "遡及処罰の禁止"], note: "P.22" },
            { category: "6. 法の機能と種類 (P22)", question: "逮捕や捜索には、現行犯を除き裁判官の発する何が必要ですか？", answer: "令状", options: ["令状", "許可証", "命令書", "判決文"], note: "P.22 令状主義" },
            { category: "6. 法の機能と種類 (P22)", question: "人権相互の衝突を調整するための原理を何といいますか？", answer: "公共の福祉", options: ["公共の福祉", "公序良俗", "信義誠実", "権利の濫用"], note: "P.22" },

            // --- 第2編 第1章 自由・平等 (P23) ---
            { category: "7. 自由権と平等権 (P23)", question: "個人の内面的な精神活動の自由を何といいますか？", answer: "内心の自由", options: ["内心の自由", "身体の自由", "経済的自由", "人身の自由"], note: "P.23" },
            { category: "7. 自由権と平等権 (P23)", question: "国家が特定の宗教と結びついてはならないという原則を何といいますか？", answer: "政教分離の原則", options: ["政教分離の原則", "信教の自由", "宗教的中立性", "世俗主義"], note: "P.23" },
            { category: "7. 自由権と平等権 (P23)", question: "愛媛玉串料訴訟などで用いられた、行為の目的と効果から合憲性を判断する基準は？", answer: "目的効果基準", options: ["目的効果基準", "二重の基準", "明白かつ現在の危険", "LRAの基準"], note: "P.23" },
            { category: "7. 自由権と平等権 (P23)", question: "精神的自由の規制は、経済的自由よりも厳格に審査すべきという考え方を何といいますか？", answer: "二重の基準", options: ["二重の基準", "目的効果基準", "合理的配慮", "明白性の原則"], note: "P.23" },
            { category: "7. 自由権と平等権 (P23)", question: "すべて国民は法の下に平等であり、人種や何によって差別されないと規定されていますか？", answer: "信条", options: ["信条", "能力", "学歴", "資産"], note: "P.23" },
            { category: "7. 自由権と平等権 (P23)", question: "尊属殺人を重く罰する規定を違憲とした訴訟を何といいますか？", answer: "尊属殺人重罰規定違憲訴訟", options: ["尊属殺人重罰規定違憲訴訟", "愛媛玉串料訴訟", "朝日訴訟", "堀木訴訟"], note: "P.23" },
            { category: "7. 自由権と平等権 (P23)", question: "女性のみに課されていた再婚禁止期間（100日超の部分）を違憲とした訴訟は？", answer: "女性再婚禁止期間規定訴訟", options: ["女性再婚禁止期間規定訴訟", "非嫡出子相続分差別訴訟", "国籍法違憲訴訟", "夫婦別姓訴訟"], note: "P.23" },
            { category: "7. 自由権と平等権 (P23)", question: "婚外子の相続分を婚内子の半分とする規定を違憲とした訴訟は？", answer: "非嫡出子相続分差別訴訟", options: ["非嫡出子相続分差別訴訟", "国籍法違憲訴訟", "尊属殺人訴訟", "再婚禁止訴訟"], note: "P.23" },
            { category: "7. 自由権と平等権 (P23)", question: "アイヌ民族を初めて法律で「先住民族」と明記した法律は？", answer: "アイヌ施策推進法", options: ["アイヌ施策推進法", "アイヌ文化振興法", "北海道旧土人保護法", "人種差別撤廃法"], note: "P.23" },
            { category: "7. 自由権と平等権 (P23)", question: "行政や企業に、障害者への「合理的配慮」を義務付けた法律は？", answer: "障害者差別解消法", options: ["障害者差別解消法", "障害者基本法", "バリアフリー法", "ハートビル法"], note: "P.23" },
            { category: "7. 自由権と平等権 (P23)", question: "日本の国籍法が採用している、親の国籍で子の国籍が決まる原則は？", answer: "血統主義", options: ["血統主義", "出生地主義", "居住地主義", "二重国籍主義"], note: "P.23 Check File" },

            // --- 第2編 第1章 社会権・新しい人権 (P24) ---
            { category: "8. 社会権と新しい人権 (P24)", question: "国民が政治に参加する権利を総称して何といいますか？", answer: "参政権", options: ["参政権", "社会権", "自由権", "請求権"], note: "P.24" },
            { category: "8. 社会権と新しい人権 (P24)", question: "最高裁裁判官を国民が辞めさせるかどうか決める制度を何といいますか？", answer: "国民審査", options: ["国民審査", "国民投票", "弾劾裁判", "住民投票"], note: "P.24" },
            { category: "8. 社会権と新しい人権 (P24)", question: "人権侵害の救済を求めたりするための権利（裁判を受ける権利など）を総称して何といいますか？", answer: "国務請求権", options: ["国務請求権", "社会権", "参政権", "自由権"], note: "P.24 請求権" },
            { category: "8. 社会権と新しい人権 (P24)", question: "健康で文化的な最低限度の生活を営む権利を何といいますか？", answer: "生存権", options: ["生存権", "幸福追求権", "環境権", "人格権"], note: "P.24" },
            { category: "8. 社会権と新しい人権 (P24)", question: "生存権をめぐり、生活保護基準の合憲性が争われた訴訟は？", answer: "朝日訴訟", options: ["朝日訴訟", "堀木訴訟", "長沼ナイキ訴訟", "恵庭事件"], note: "P.24" },
            { category: "8. 社会権と新しい人権 (P24)", question: "朝日訴訟で最高裁が示した、憲法25条は国の努力目標を定めたものだとする説は？", answer: "プログラム規定説", options: ["プログラム規定説", "法的権利説", "抽象的権利説", "具体的権利説"], note: "P.24" },
            { category: "8. 社会権と新しい人権 (P24)", question: "労働三権とは、団結権、団体交渉権と何ですか？", answer: "団体行動権", options: ["団体行動権", "争議権", "労働権", "団結権"], note: "P.24 争議権ともいう" },
            { category: "8. 社会権と新しい人権 (P24)", question: "大阪国際空港公害訴訟などで根拠とされた、静穏な環境を求める権利は？", answer: "環境権", options: ["環境権", "日照権", "人格権", "静穏権"], note: "P.24" },
            { category: "8. 社会権と新しい人権 (P24)", question: "政府などの持つ情報の開示を求める権利を何といいますか？", answer: "知る権利", options: ["知る権利", "アクセス権", "プライバシー権", "請求権"], note: "P.24" },
            { category: "8. 社会権と新しい人権 (P24)", question: "マスメディアに対して反論記事の掲載などを求める権利を何といいますか？", answer: "アクセス権", options: ["アクセス権", "知る権利", "報道の自由", "取材の自由"], note: "P.24 反論権" },
            { category: "8. 社会権と新しい人権 (P24)", question: "自己に関する情報を自ら管理・コントロールする権利を何といいますか？", answer: "プライバシーの権利", options: ["プライバシーの権利", "肖像権", "パブリシティ権", "忘れられる権利"], note: "P.24 現代的な定義" },
            { category: "8. 社会権と新しい人権 (P24)", question: "インターネット上の過去の不利益な情報の削除を求める権利を何といいますか？", answer: "忘れられる権利", options: ["忘れられる権利", "知る権利", "アクセス権", "肖像権"], note: "P.24" },
            { category: "8. 社会権と新しい人権 (P24)", question: "医療現場などで、患者が十分な説明を受けた上で治療に同意することを何といいますか？", answer: "インフォームド・コンセント", options: ["インフォームド・コンセント", "セカンド・オピニオン", "リビング・ウィル", "ターミナル・ケア"], note: "P.24" },

            // --- 第2編 第3章 環境問題 (P57, P71) ---
            { category: "9. 公害と環境問題 (P57, P71)", question: "経済活動によって第三者に意図せず不利益を与えることを何といいますか？", answer: "外部不経済", options: ["外部不経済", "市場の失敗", "フリーライダー", "モラルハザード"], note: "P.57 公害の原因" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "公害対策基本法に代わり、1993年に制定された法律は？", answer: "環境基本法", options: ["環境基本法", "循環型社会形成推進基本法", "自然環境保全法", "公害防止条例"], note: "P.57" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "公害において、企業に過失がなくても賠償責任を負わせる原則を何といいますか？", answer: "無過失責任", options: ["無過失責任", "過失責任", "製造物責任", "危険責任"], note: "P.57" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "公害防止費用は汚染者が負担すべきという原則（PPP）を日本語で何といいますか？", answer: "汚染者負担の原則", options: ["汚染者負担の原則", "拡大生産者責任", "無過失責任", "予防原則"], note: "P.57" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "大規模開発の前に、環境への影響を調査・評価することを何といいますか？", answer: "環境アセスメント", options: ["環境アセスメント", "環境モニタリング", "環境マネジメント", "コンプライアンス"], note: "P.57 環境影響評価" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "市民が募金などで土地を買い取り、自然を守る運動を何といいますか？", answer: "ナショナル・トラスト", options: ["ナショナル・トラスト", "グリーン・ベルト", "エコツーリズム", "ビオトープ"], note: "P.57" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "地球温暖化の原因となる二酸化炭素などのガスを総称して何といいますか？", answer: "温室効果ガス", options: ["温室効果ガス", "フロンガス", "オゾン層", "PM2.5"], note: "P.71" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "オゾン層を破壊する物質として規制されたガスは？", answer: "フロンガス", options: ["フロンガス", "メタンガス", "二酸化炭素", "亜硫酸ガス"], note: "P.71" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "オゾン層保護のための条約（ウィーン条約）に基づき、具体的な規制を定めた議定書は？", answer: "モントリオール議定書", options: ["モントリオール議定書", "京都議定書", "名古屋議定書", "カルタヘナ議定書"], note: "P.71" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "水鳥の生息地として重要な湿地を保護する条約は？", answer: "ラムサール条約", options: ["ラムサール条約", "ワシントン条約", "バーゼル条約", "ロンドン条約"], note: "P.71" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "絶滅のおそれのある野生動植物の国際取引を規制する条約は？", answer: "ワシントン条約", options: ["ワシントン条約", "ラムサール条約", "ボン条約", "生物多様性条約"], note: "P.71" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "1992年の地球サミット（リオデジャネイロ）で採択されたスローガン的な宣言は？", answer: "リオ宣言", options: ["リオ宣言", "ストックホルム宣言", "ヨハネスブルク宣言", "パリ協定"], note: "P.71" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "1997年に採択された、先進国の温室効果ガス削減目標を定めた議定書は？", answer: "京都議定書", options: ["京都議定書", "パリ協定", "モントリオール議定書", "コペンハーゲン合意"], note: "P.71" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "京都議定書で導入された、排出枠の売買などを認める仕組みを総称して何といいますか？", answer: "京都メカニズム", options: ["京都メカニズム", "排出量取引", "クリーン開発メカニズム", "共同実施"], note: "P.71" },
            { category: "9. 公害と環境問題 (P57, P71)", question: "2015年に採択された、全ての国が参加する地球温暖化対策の枠組みは？", answer: "パリ協定", options: ["パリ協定", "京都議定書", "ドーハ改定", "カンクン合意"], note: "P.71" },

            // --- 第2編 第3章 資源・エネルギー (P72) ---
            { category: "10. 資源・エネルギー (P72)", question: "確認埋蔵量を年間生産量で割った、あと何年採掘できるかを示す指標は？", answer: "可採年数", options: ["可採年数", "耐用年数", "埋蔵寿命", "資源限界"], note: "P.72" },
            { category: "10. 資源・エネルギー (P72)", question: "エネルギー源の中心が石炭から石油へ転換したことを何といいますか？", answer: "エネルギー革命", options: ["エネルギー革命", "産業革命", "緑の革命", "IT革命"], note: "P.72" },
            { category: "10. 資源・エネルギー (P72)", question: "アメリカなどで生産が増加した、新しい天然ガス資源は？", answer: "シェールガス", options: ["シェールガス", "メタンハイドレート", "オイルサンド", "バイオガス"], note: "P.72" },
            { category: "10. 資源・エネルギー (P72)", question: "ハイテク製品に不可欠な希少金属を何といいますか？", answer: "レアメタル", options: ["レアメタル", "レアアース", "ベースメタル", "プレシャスメタル"], note: "P.72" },
            { category: "10. 資源・エネルギー (P72)", question: "輸入食料を生産するのに必要な水の量を推定した概念は？", answer: "バーチャルウォーター", options: ["バーチャルウォーター", "ウォーターフットプリント", "フードマイレージ", "エコロジカル・リュックサック"], note: "P.72 仮想水" },
            { category: "10. 資源・エネルギー (P72)", question: "再生可能エネルギーの普及のため、電力会社に買い取りを義務付けた制度（FIT）は？", answer: "固定価格買取制度", options: ["固定価格買取制度", "RPS制度", "排出量取引制度", "炭素税"], note: "P.72" },
            { category: "10. 資源・エネルギー (P72)", question: "発電時の排熱を給湯などに利用してエネルギー効率を高めるシステムは？", answer: "コージェネレーション", options: ["コージェネレーション", "ヒートポンプ", "コンバインドサイクル", "スマートグリッド"], note: "P.72 熱電併給" },
            { category: "10. 資源・エネルギー (P72)", question: "IT技術を活用して電力需給を最適化する次世代送電網は？", answer: "スマートグリッド", options: ["スマートグリッド", "スマートシティ", "マイクログリッド", "パワーグリッド"], note: "P.72" },
            { category: "10. 資源・エネルギー (P72)", question: "廃棄物の発生抑制、再使用、再生利用の3つを総称して何といいますか？", answer: "3R", options: ["3R", "3C", "3K", "ISO"], note: "P.72" },
            { category: "10. 資源・エネルギー (P72)", question: "循環型社会形成推進基本法で、最も優先順位が高いとされるのは？", answer: "リデュース", options: ["リデュース", "リユース", "リサイクル", "熱回収"], note: "P.72 発生抑制" },
            { category: "10. 資源・エネルギー (P72)", question: "国などが率先して環境負荷の少ない製品を購入することを定めた法律は？", answer: "グリーン購入法", options: ["グリーン購入法", "リサイクル法", "環境基本法", "省エネ法"], note: "P.72" },

            // --- 第2編 第3章 国際社会 (P73) ---
            { category: "11. 国際社会の課題 (P73)", question: "発展途上国などで人口が急激に増加する現象を何といいますか？", answer: "人口爆発", options: ["人口爆発", "人口オーナス", "ベビーブーム", "ドーナツ化現象"], note: "P.73" },
            { category: "11. 国際社会の課題 (P73)", question: "UNDPが発表している、平均寿命や教育水準を加味した豊かさの指標は？", answer: "人間開発指数", options: ["人間開発指数", "GDP", "GNI", "GNH"], note: "P.73 HDI" },
            { category: "11. 国際社会の課題 (P73)", question: "性と生殖に関する健康・権利をカタカナで何といいますか？", answer: "リプロダクティブ・ヘルス/ライツ", options: ["リプロダクティブ・ヘルス/ライツ", "エンパワーメント", "ジェンダー・フリー", "ノーマライゼーション"], note: "P.73" },
            { category: "11. 国際社会の課題 (P73)", question: "先進国を中心とする「経済協力開発機構」の略称は？", answer: "OECD", options: ["OECD", "WTO", "IMF", "WHO"], note: "P.73" },
            { category: "11. 国際社会の課題 (P73)", question: "貧困や環境破壊などから個人を守るという考え方を「◯◯の安全保障」といいます。", answer: "人間", options: ["人間", "国家", "集団", "経済"], note: "P.73" },
            { category: "11. 国際社会の課題 (P73)", question: "2015年に国連で採択された「持続可能な開発目標」の略称は？", answer: "SDGs", options: ["SDGs", "MDGs", "ODA", "NGO"], note: "P.73" }
        ];

        // ユーティリティ: 配列のシャッフル
        const shuffleArray = (array) => {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        };

        const QuizApp = () => {
            const [gameState, setGameState] = useState('menu'); // menu, playing, result
            const [selectedCategory, setSelectedCategory] = useState(null);
            const [questions, setQuestions] = useState([]);
            const [currentIndex, setCurrentIndex] = useState(0);
            const [score, setScore] = useState(0);
            const [showAnswer, setShowAnswer] = useState(false);
            const [userSelected, setUserSelected] = useState(null);
            
            // 重要: モード設定 (choice: 選択式, think: 記述/暗記式)
            const [studyMode, setStudyMode] = useState('choice'); 
            const [choicesHidden, setChoicesHidden] = useState(false);

            // カテゴリ一覧抽出
            const categories = useMemo(() => [...new Set(quizDatabase.map(q => q.category))], []);

            // クイズ開始処理
            const startQuiz = (category, mode) => {
                let qs = [];
                if (category === 'ALL') {
                    qs = [...quizDatabase];
                } else {
                    qs = quizDatabase.filter(q => q.category === category);
                }
                
                // 問題順シャッフル
                qs = shuffleArray(qs);
                
                // 各問題の選択肢もシャッフルする
                qs = qs.map(q => ({
                    ...q,
                    shuffledOptions: shuffleArray(q.options)
                }));
                
                setQuestions(qs);
                setCurrentIndex(0);
                setScore(0);
                setShowAnswer(false);
                setUserSelected(null);
                setSelectedCategory(category === 'ALL' ? '全問チャレンジ' : category);
                setStudyMode(mode);
                setChoicesHidden(mode === 'think'); // 記述モードなら最初は隠す
                setGameState('playing');
            };

            const handleAnswer = (option) => {
                setUserSelected(option);
                setShowAnswer(true);
                if (option === questions[currentIndex].answer) {
                    setScore(prev => prev + 1);
                }
            };

            const revealChoices = () => {
                setChoicesHidden(false);
            };

            const nextQuestion = () => {
                if (currentIndex < questions.length - 1) {
                    setCurrentIndex(prev => prev + 1);
                    setShowAnswer(false);
                    setUserSelected(null);
                    setChoicesHidden(studyMode === 'think'); // 記述モードなら次の問題も隠す
                } else {
                    setGameState('result');
                }
            };

            // --- メニュー画面 ---
            if (gameState === 'menu') {
                return (
                    <div className="flex flex-col h-full bg-slate-50 overflow-hidden">
                        <header className="bg-indigo-600 text-white p-4 shadow-md z-10">
                            <h1 className="text-xl md:text-2xl font-bold text-center">公共・政治経済 完全攻略</h1>
                            <p className="text-center text-indigo-200 text-sm">全{quizDatabase.length}問 - ノート完全網羅</p>
                        </header>
                        
                        <div className="flex-1 overflow-y-auto p-4 max-w-3xl mx-auto w-full">
                            {/* モード説明 */}
                            <div className="bg-white p-4 rounded-xl shadow-sm border border-slate-200 mb-6">
                                <h2 className="font-bold text-slate-700 mb-2">学習モードを選択してスタート</h2>
                                <div className="grid grid-cols-2 gap-3 mb-2">
                                    <div className={`p-3 rounded-lg border-2 text-center text-sm ${studyMode === 'choice' ? 'border-indigo-500 bg-indigo-50 text-indigo-700' : 'border-slate-100 text-slate-400'}`}>
                                        <div className="font-bold">① 選択肢モード</div>
                                        <div className="text-xs">最初から選択肢を表示</div>
                                    </div>
                                    <div className={`p-3 rounded-lg border-2 text-center text-sm ${studyMode === 'think' ? 'border-indigo-500 bg-indigo-50 text-indigo-700' : 'border-slate-100 text-slate-400'}`}>
                                        <div className="font-bold">② 記述(暗記)モード</div>
                                        <div className="text-xs">最初は選択肢を隠す</div>
                                    </div>
                                </div>
                            </div>

                            <div className="bg-gradient-to-r from-indigo-500 to-purple-600 p-6 rounded-2xl shadow-lg mb-6 text-white">
                                <h2 className="text-lg font-bold mb-1 flex items-center">
                                    <span className="bg-yellow-400 text-indigo-900 px-2 py-0.5 rounded text-xs mr-2">おすすめ</span>
                                    全問ランダム演習
                                </h2>
                                <p className="text-indigo-100 text-sm mb-4">全185問からランダムに出題されます。</p>
                                <div className="grid grid-cols-2 gap-3">
                                    <button onClick={() => startQuiz('ALL', 'choice')} className="bg-white text-indigo-600 py-2 rounded-lg font-bold hover:bg-indigo-50 transition text-sm">
                                        選択肢あり
                                    </button>
                                    <button onClick={() => startQuiz('ALL', 'think')} className="bg-indigo-800 text-white py-2 rounded-lg font-bold hover:bg-indigo-900 transition text-sm border border-indigo-400">
                                        記述(暗記)
                                    </button>
                                </div>
                            </div>

                            <h3 className="text-slate-500 font-bold mb-3 pl-1">章ごとに学習</h3>
                            <div className="space-y-3">
                                {categories.map((cat, idx) => (
                                    <div key={idx} className="bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex flex-col sm:flex-row sm:items-center justify-between gap-3">
                                        <div>
                                            <div className="font-bold text-slate-700">{cat}</div>
                                            <div className="text-xs text-slate-400">{quizDatabase.filter(q => q.category === cat).length}問</div>
                                        </div>
                                        <div className="flex gap-2">
                                            <button onClick={() => startQuiz(cat, 'choice')} className="flex-1 sm:flex-none px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg text-sm font-bold transition">
                                                選択肢
                                            </button>
                                            <button onClick={() => startQuiz(cat, 'think')} className="flex-1 sm:flex-none px-4 py-2 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 rounded-lg text-sm font-bold transition">
                                                暗記
                                            </button>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            // --- 結果画面 ---
            if (gameState === 'result') {
                const percentage = Math.round((score / questions.length) * 100);
                return (
                    <div className="flex flex-col h-full items-center justify-center p-6 bg-slate-50">
                        <div className="bg-white p-8 rounded-3xl shadow-xl w-full max-w-md text-center fade-in border border-slate-100">
                            <h2 className="text-slate-500 font-bold mb-2">{selectedCategory}</h2>
                            <div className="text-5xl font-black text-indigo-600 mb-4">
                                {score} <span className="text-xl text-slate-400">/ {questions.length}</span>
                            </div>
                            <div className="w-full bg-slate-100 rounded-full h-3 mb-6 overflow-hidden">
                                <div className="bg-indigo-500 h-full transition-all duration-1000" style={{width: `${percentage}%`}}></div>
                            </div>
                            <p className="text-lg font-bold text-slate-700 mb-8">
                                {percentage === 100 ? "完璧です！素晴らしい！🎉" : percentage >= 80 ? "合格点です！その調子！👍" : "復習して完璧を目指そう！💪"}
                            </p>
                            <button onClick={() => setGameState('menu')} className="w-full bg-slate-800 text-white py-3 rounded-xl font-bold hover:bg-slate-700 transition">
                                メニューに戻る
                            </button>
                        </div>
                    </div>
                );
            }

            // --- クイズプレイ画面 ---
            const currentQ = questions[currentIndex];
            
            return (
                <div className="flex flex-col h-full bg-slate-50">
                    {/* ヘッダー */}
                    <div className="bg-white p-4 shadow-sm z-10 flex justify-between items-center border-b border-slate-100">
                        <div className="text-xs font-bold text-slate-400 bg-slate-100 px-2 py-1 rounded truncate max-w-[150px]">{selectedCategory}</div>
                        <div className="font-bold text-slate-600 text-sm whitespace-nowrap">
                            {currentIndex + 1} <span className="text-slate-400">/ {questions.length}</span>
                        </div>
                    </div>
                    <div className="w-full bg-slate-200 h-1">
                        <div className="bg-indigo-500 h-1 transition-all duration-300" style={{width: `${((currentIndex + 1) / questions.length) * 100}%`}}></div>
                    </div>

                    {/* メインコンテンツ */}
                    <div className="flex-1 overflow-y-auto p-4 pb-24 max-w-2xl mx-auto w-full">
                        {/* 問題文 */}
                        <div className="bg-white p-6 md:p-8 rounded-2xl shadow-sm border border-slate-200 mb-6">
                            <h2 className="text-lg md:text-xl font-bold text-slate-800 leading-relaxed mb-4">
                                {currentQ.question}
                            </h2>
                            <div className="text-right">
                                <span className="text-xs text-slate-400 bg-slate-100 px-2 py-1 rounded">ノート: {currentQ.note}</span>
                            </div>
                        </div>

                        {/* 選択肢エリア */}
                        <div className="relative">
                            {/* 記述モード時のマスク (choicesHiddenがtrueの時だけ表示) */}
                            {choicesHidden && (
                                <div className="absolute inset-0 z-10 bg-slate-50/90 backdrop-blur-[2px] rounded-xl flex items-center justify-center border-2 border-dashed border-slate-300">
                                    <div className="text-center p-6">
                                        <div className="mb-4 text-slate-600 font-bold text-lg">答えを思い浮かべてください</div>
                                        <button 
                                            onClick={revealChoices}
                                            className="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-full font-bold shadow-lg transition transform hover:scale-105"
                                        >
                                            選択肢を表示する
                                        </button>
                                    </div>
                                </div>
                            )}

                            {/* 選択肢リスト (常にレンダリングはされるが、マスクで隠される場合がある) */}
                            <div className={`space-y-3 transition-opacity duration-300 ${choicesHidden ? 'opacity-20 pointer-events-none' : 'opacity-100'}`}>
                                {currentQ.shuffledOptions.map((option, idx) => {
                                    let btnClass = "w-full p-4 rounded-xl text-left font-medium transition-all duration-200 border-2 relative ";
                                    
                                    if (showAnswer) {
                                        if (option === currentQ.answer) {
                                            btnClass += "bg-green-50 border-green-500 text-green-800";
                                        } else if (option === userSelected) {
                                            btnClass += "bg-red-50 border-red-500 text-red-800";
                                        } else {
                                            btnClass += "bg-white border-slate-100 text-slate-400 opacity-50";
                                        }
                                    } else {
                                        btnClass += "bg-white border-slate-100 hover:border-indigo-400 hover:bg-indigo-50 text-slate-700 shadow-sm";
                                    }

                                    return (
                                        <button
                                            key={idx}
                                            onClick={() => !showAnswer && handleAnswer(option)}
                                            disabled={showAnswer || choicesHidden}
                                            className={btnClass}
                                        >
                                            <span className="mr-3 inline-block w-6 text-center font-bold text-slate-300">{idx+1}.</span>
                                            {option}
                                            {showAnswer && option === currentQ.answer && (
                                                <span className="absolute right-4 text-green-600 font-bold">◎ 正解</span>
                                            )}
                                        </button>
                                    );
                                })}
                            </div>
                        </div>
                    </div>

                    {/* 正解表示フッター */}
                    {showAnswer && (
                        <div className="bg-white border-t border-slate-200 p-4 fixed bottom-0 left-0 right-0 z-20 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] fade-in">
                            <div className="max-w-2xl mx-auto flex items-center justify-between gap-4">
                                <div className="flex-1">
                                    <div className="text-xs font-bold text-slate-400 mb-1">正解</div>
                                    <div className="text-lg font-bold text-green-600 leading-tight">{currentQ.answer}</div>
                                </div>
                                <button 
                                    onClick={nextQuestion}
                                    className="bg-indigo-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-indigo-700 transition shadow-lg flex items-center"
                                >
                                    次へ <span className="ml-2">→</span>
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<QuizApp />);
    </script>
</body>
</html>
```
```