<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>公共・政治経済マスター（極）</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght@400;500;700;900&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Zen Kaku Gothic New"', 'sans-serif'],
                    },
                    colors: {
                        primary: '#6366f1', // Indigo 500
                        primaryDark: '#4338ca', // Indigo 700
                        secondary: '#10b981', // Emerald 500
                        accent: '#f59e0b', // Amber 500
                        danger: '#ef4444', // Red 500
                        bg: '#f8fafc', // Slate 50
                    },
                    animation: {
                        'bounce-slight': 'bounce-slight 0.3s infinite alternate',
                    },
                    keyframes: {
                        'bounce-slight': {
                            '0%': { transform: 'translateY(0)' },
                            '100%': { transform: 'translateY(-5px)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #f8fafc; color: #1e293b; -webkit-tap-highlight-color: transparent; }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        .slide-up { animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .pop-in { animation: popIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        
        /* スクロールバー */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback } = React;

        // --- クイズデータ (250問超) ---
        const quizDatabase = [
            // --- 第1編 第3章 人間の尊厳 (P1-P2) ---
            { category: "1. 人間の尊厳と平等", question: "自分にとって望ましい死のあり方を、判断能力があるうちに文書などで生前に意思表明しておくことを何といいますか？", answer: "リビング・ウィル", options: ["リビング・ウィル", "インフォームド・コンセント", "パターナリズム", "ホスピス"], note: "P.1 尊厳死宣言" },
            { category: "1. 人間の尊厳と平等", question: "生命の尊厳をアルファベット3文字で何といいますか？", answer: "SOL", options: ["SOL", "QOL", "ADL", "WHO"], note: "P.1 Sanctity of Life" },
            { category: "1. 人間の尊厳と平等", question: "みずからの意思により、延命治療の停止を希望し、自然な死を選択することを何といいますか？", answer: "尊厳死", options: ["尊厳死", "安楽死", "脳死", "平穏死"], note: "P.1" },
            { category: "1. 人間の尊厳と平等", question: "本人の意思や家族の同意の下、薬物などの人為的な手段によって死期を早めることを何といいますか？", answer: "安楽死", options: ["安楽死", "尊厳死", "自然死", "自殺幇助"], note: "P.1 オランダ等で合法化" },
            { category: "1. 人間の尊厳と平等", question: "人工心肺装置や人工呼吸器などの延命治療を可能にした装置を総称して何といいますか？", answer: "生命維持装置", options: ["生命維持装置", "延命装置", "医療補助装置", "蘇生装置"], note: "P.1" },
            { category: "1. 人間の尊厳と平等", question: "多数派に対して、社会的・数的に弱い立場にある「少数派」を何といいますか？", answer: "マイノリティ", options: ["マイノリティ", "マジョリティ", "コミュニティ", "アイデンティティ"], note: "P.1" },
            { category: "1. 人間の尊厳と平等", question: "『第二の性』で「人は女に生まれるのではない、女になるのだ」と述べたフランスの思想家は？", answer: "ボーヴォワール", options: ["ボーヴォワール", "サルトル", "アレント", "ナイチンゲール"], note: "P.1" },
            { category: "1. 人間の尊厳と平等", question: "社会に参加し、人類全体への責任を負いつつ社会変革に関わることを、サルトルは何と呼びましたか？", answer: "アンガージュマン", options: ["アンガージュマン", "イニシエーション", "パラダイム", "モラトリアム"], note: "P.1" },
            { category: "1. 人間の尊厳と平等", question: "「憎しみには愛をもってこたえなければならない」と説き、非暴力・不服従を貫いた人物は？", answer: "キング牧師", options: ["キング牧師", "ガンディー", "マンデラ", "マルコムX"], note: "P.1" },
            { category: "1. 人間の尊厳と平等", question: "1999年に制定された、男女が互いに人権を尊重しつつ責任を分かち合う社会を目指す法律は？", answer: "男女共同参画社会基本法", options: ["男女共同参画社会基本法", "男女雇用機会均等法", "女性活躍推進法", "育児・介護休業法"], note: "P.2" },
            { category: "1. 人間の尊厳と平等", question: "実質的な機会均等を目指し、差別されてきたグループに対して暫定的に優遇措置をとることを何といいますか？", answer: "ポジティブ・アクション", options: ["ポジティブ・アクション", "ノーマライゼーション", "セーフティネット", "ワーク・ライフ・バランス"], note: "P.2" },
            { category: "1. 人間の尊厳と平等", question: "アメリカなどで「ポジティブ・アクション」のことを何と呼びますか？", answer: "アファーマティブ・アクション", options: ["アファーマティブ・アクション", "ネガティブ・アクション", "ダイレクト・アクション", "シビル・アクション"], note: "P.2" },
            { category: "1. 人間の尊厳と平等", question: "2015年に制定され、企業に女性の管理職登用などの数値目標設定を求めた法律は？", answer: "女性活躍推進法", options: ["女性活躍推進法", "男女雇用機会均等法", "政治分野における男女共同参画推進法", "パートタイム労働法"], note: "P.2" },
            { category: "1. 人間の尊厳と平等", question: "2018年に制定された、選挙での男女の候補者数の均等を目指す法律は？", answer: "候補者男女均等法", options: ["候補者男女均等法", "公職選挙法", "政党助成法", "女性活躍推進法"], note: "P.2" },
            { category: "1. 人間の尊厳と平等", question: "「男は仕事、女は家庭」といった、社会的・文化的に作られた性別による役割分担を何といいますか？", answer: "性別役割分担", options: ["性別役割分担", "ジェンダー・ギャップ", "ガラスの天井", "マミー・トラック"], note: "P.2" },

            // --- 第1編 第3章 個人の尊重 (P3) ---
            { category: "2. 人権の歴史と国際社会", question: "1215年、イギリスの貴族が王権を制限させた文書は何ですか？", answer: "マグナ・カルタ", options: ["マグナ・カルタ", "権利請願", "権利章典", "人身保護法"], note: "P.3 大憲章" },
            { category: "2. 人権の歴史と国際社会", question: "1628年、イギリス議会がチャールズ1世に提出した文書は何ですか？", answer: "権利請願", options: ["権利請願", "権利章典", "マグナ・カルタ", "独立宣言"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会", question: "1689年、名誉革命の結果として制定された文書は何ですか？", answer: "権利章典", options: ["権利章典", "権利請願", "人権宣言", "バージニア権利章典"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会", question: "1776年、基本的人権を定めた世界初の成文憲法といわれるアメリカの文書は？", answer: "バージニア権利章典", options: ["バージニア権利章典", "アメリカ独立宣言", "フランス人権宣言", "マサチューセッツ憲法"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会", question: "1776年のアメリカ独立宣言で、「天から与えられた」と表現された人権概念は？", answer: "天賦人権", options: ["天賦人権", "自然権", "社会権", "抵抗権"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会", question: "1789年のフランス人権宣言で、「自然権」として保障されたのは、自由・所有権・安全と何ですか？", answer: "圧制への抵抗", options: ["圧制への抵抗", "幸福追求権", "環境権", "プライバシー権"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会", question: "国家からの自由（自由権）に対し、人間らしい生活を求める権利を何といいますか？", answer: "社会権", options: ["社会権", "参政権", "請求権", "平等権"], note: "P.3 20世紀的人権" },
            { category: "2. 人権の歴史と国際社会", question: "1919年に制定され、世界で初めて社会権を保障した憲法は？", answer: "ワイマール憲法", options: ["ワイマール憲法", "フランス憲法", "日本国憲法", "ソビエト憲法"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会", question: "1948年に国連で採択された、世界共通の人権基準を示した宣言は？", answer: "世界人権宣言", options: ["世界人権宣言", "国際人権規約", "児童の権利条約", "人種差別撤廃条約"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会", question: "世界人権宣言には法的拘束力がありますか？", answer: "ない", options: ["ない", "ある", "一部ある", "条約による"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会", question: "1966年に採択され、世界人権宣言を条約化して法的拘束力を持たせたものは？", answer: "国際人権規約", options: ["国際人権規約", "ウィーン条約", "パリ協定", "ハーグ条約"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会", question: "国際人権規約のA規約は何に関するものですか？", answer: "社会権", options: ["社会権", "自由権", "参政権", "環境権"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会", question: "国際人権規約のB規約は何に関するものですか？", answer: "自由権", options: ["自由権", "社会権", "平和権", "発展権"], note: "P.3" },
            { category: "2. 人権の歴史と国際社会", question: "国連人権理事会の略称は？", answer: "UNHRC", options: ["UNHRC", "UNHCR", "UNESCO", "UNICEF"], note: "P.3" },

            // --- 第1編 第3章 民主政治の原理 (P4-P5) ---
            { category: "3. 民主政治の原理", question: "国王の権力は神から与えられたとする説を何といいますか？", answer: "王権神授説", options: ["王権神授説", "社会契約説", "法治主義", "立憲主義"], note: "P.4" },
            { category: "3. 民主政治の原理", question: "人々が契約を結んで国家を作ったとする考え方を何といいますか？", answer: "社会契約説", options: ["社会契約説", "王権神授説", "自然法思想", "功利主義"], note: "P.4" },
            { category: "3. 民主政治の原理", question: "『リバイアサン』で、自然状態を「万人の万人に対する闘争」と説いた人物は？", answer: "ホッブズ", options: ["ホッブズ", "ロック", "ルソー", "モンテスキュー"], note: "P.4" },
            { category: "3. 民主政治の原理", question: "ホッブズが主張した、平和維持のために譲渡すべきものは？", answer: "自然権", options: ["自然権", "主権", "財産権", "自由権"], note: "P.4" },
            { category: "3. 民主政治の原理", question: "『市民政府二論』で、抵抗権（革命権）を認めた人物は？", answer: "ロック", options: ["ロック", "ホッブズ", "ルソー", "カント"], note: "P.4" },
            { category: "3. 民主政治の原理", question: "ロックが主張した、政府に権力を委ねることを何といいますか？", answer: "信託", options: ["信託", "譲渡", "契約", "服従"], note: "P.4" },
            { category: "3. 民主政治の原理", question: "『社会契約論』で、一般意思に基づく人民主権を説いた人物は？", answer: "ルソー", options: ["ルソー", "ロック", "ホッブズ", "ヘーゲル"], note: "P.4" },
            { category: "3. 民主政治の原理", question: "ルソーが重視した、社会共通の幸福を求める意思を何といいますか？", answer: "一般意思", options: ["一般意思", "特殊意思", "全体意思", "多数意思"], note: "P.4" },
            { category: "3. 民主政治の原理", question: "国家の役割を治安維持などに限定する国家観（小さな政府）を何といいますか？", answer: "夜警国家", options: ["夜警国家", "福祉国家", "警察国家", "全体主義国家"], note: "P.4" },
            { category: "3. 民主政治の原理", question: "国民の生活を幅広く保障する国家観（大きな政府）を何といいますか？", answer: "福祉国家", options: ["福祉国家", "夜警国家", "行政国家", "立法国家"], note: "P.4" },
            { category: "3. 民主政治の原理", question: "普通選挙制のもとで、大衆が政治に参加する民主主義を何といいますか？", answer: "大衆民主主義", options: ["大衆民主主義", "制限民主主義", "エリート民主主義", "草の根民主主義"], note: "P.4" },
            { category: "3. 民主政治の原理", question: "国家のあり方を最終的に決める権力が国民にあることを何といいますか？", answer: "国民主権", options: ["国民主権", "君主主権", "国家主権", "議会主権"], note: "P.4" },
            { category: "3. 民主政治の原理", question: "国民全員が直接政治に参加する制度を何といいますか？", answer: "直接民主制", options: ["直接民主制", "間接民主制", "代表民主制", "議会制"], note: "P.4" },
            { category: "3. 民主政治の原理", question: "国民が選んだ代表者が政治を行う制度を何といいますか？", answer: "間接民主制", options: ["間接民主制", "直接民主制", "国民投票制", "住民投票制"], note: "P.5" },
            { category: "3. 民主政治の原理", question: "議会は一部の選挙民ではなく国民全体を代表するという原理は？", answer: "国民代表の原理", options: ["国民代表の原理", "審議の原理", "監督の原理", "多数決の原理"], note: "P.5" },
            { category: "3. 民主政治の原理", question: "議会は公開の場で討論を行わなければならないという原理は？", answer: "審議の原理", options: ["審議の原理", "国民代表の原理", "監督の原理", "公開の原理"], note: "P.5" },
            { category: "3. 民主政治の原理", question: "議会が行政を監視・コントロールするという原理は？", answer: "監督の原理", options: ["監督の原理", "審議の原理", "国民代表の原理", "責任の原理"], note: "P.5" },

            // --- 第1編 第3章 法の支配 (P6) ---
            { category: "4. 法の支配と政治体制", question: "権力者の恣意的な支配を排し、権力も法に拘束されるという考え方は？", answer: "法の支配", options: ["法の支配", "法治主義", "人治主義", "専制主義"], note: "P.6" },
            { category: "4. 法の支配と政治体制", question: "「王は何人の下にもあるべきではない。しかし神と法の下にあるべきである」と述べた人物は？", answer: "エドワード・コーク", options: ["エドワード・コーク", "ブラクトン", "ダイシー", "ブラックストン"], note: "P.6" },
            { category: "4. 法の支配と政治体制", question: "エドワード・コークが引用した言葉は、元々誰のものですか？", answer: "ブラクトン", options: ["ブラクトン", "ホッブズ", "ロック", "ミル"], note: "P.6" },
            { category: "4. 法の支配と政治体制", question: "ドイツで発達した、行政が法律に基づいているかという形式を重視する考え方は？", answer: "法治主義", options: ["法治主義", "法の支配", "立憲主義", "民主主義"], note: "P.6" },
            { category: "4. 法の支配と政治体制", question: "権力の濫用を防ぐため、権力を分散させて抑制と均衡を図る仕組みは？", answer: "権力分立", options: ["権力分立", "国民主権", "中央集権", "地方自治"], note: "P.6" },
            { category: "4. 法の支配と政治体制", question: "立法権・執行権・連合権の分立を唱えたのは誰ですか？", answer: "ロック", options: ["ロック", "モンテスキュー", "ホッブズ", "ルソー"], note: "P.6" },
            { category: "4. 法の支配と政治体制", question: "『法の精神』で、立法・行政・司法の三権分立を唱えたのは誰ですか？", answer: "モンテスキュー", options: ["モンテスキュー", "ロック", "ルソー", "カント"], note: "P.6" },
            { category: "4. 法の支配と政治体制", question: "憲法によって国家権力を制限し、国民の人権を守るという思想は？", answer: "立憲主義", options: ["立憲主義", "民主主義", "法治主義", "自由主義"], note: "P.6" },

            // --- 第1編 第3章 政治体制 (P8) ---
            { category: "4. 法の支配と政治体制", question: "議会と内閣が密接に関係し、内閣が議会の信任に基づいて存立する制度は？", answer: "議院内閣制", options: ["議院内閣制", "大統領制", "半大統領制", "権力集中制"], note: "P.8" },
            { category: "4. 法の支配と政治体制", question: "イギリスの下院の別名は？", answer: "庶民院", options: ["庶民院", "貴族院", "参議院", "衆議院"], note: "P.8" },
            { category: "4. 法の支配と政治体制", question: "イギリスの上院の別名は？", answer: "貴族院", options: ["貴族院", "庶民院", "元老院", "連邦参議院"], note: "P.8" },
            { category: "4. 法の支配と政治体制", question: "イギリスで、野党が政権交代に備えて組織する模擬内閣は？", answer: "影の内閣", options: ["影の内閣", "連立内閣", "暫定内閣", "挙国一致内閣"], note: "P.8 シャドー・キャビネット" },
            { category: "4. 法の支配と政治体制", question: "アメリカ大統領の任期は何年ですか？", answer: "4年", options: ["4年", "2年", "5年", "6年"], note: "P.8" },
            { category: "4. 法の支配と政治体制", question: "アメリカ大統領は何回まで選出可能ですか？", answer: "2回まで", options: ["2回まで", "3回まで", "無制限", "1回のみ"], note: "P.8 (3選禁止)" },
            { category: "4. 法の支配と政治体制", question: "アメリカ大統領が議会に対して持つ、法案を拒否する権限は？", answer: "拒否権", options: ["拒否権", "解散権", "法案提出権", "弾劾権"], note: "P.8" },
            { category: "4. 法の支配と政治体制", question: "アメリカ大統領が議会に対して政策などを勧告するために送るものは？", answer: "教書", options: ["教書", "勅語", "法案", "決議案"], note: "P.8 教書送付権" },
            { category: "4. 法の支配と政治体制", question: "フランスのように、大統領と首相が並存する体制は？", answer: "半大統領制", options: ["半大統領制", "議院内閣制", "大統領制", "専制君主制"], note: "P.8" },
            { category: "4. 法の支配と政治体制", question: "中国のように、共産党などの特定政党や機関に権力が集中する体制は？", answer: "権力集中制", options: ["権力集中制", "権力分立制", "立憲主義", "自由主義"], note: "P.8 民主集中制" },
            { category: "4. 法の支配と政治体制", question: "中国の国会に相当する機関は？", answer: "全国人民代表大会", options: ["全国人民代表大会", "連邦議会", "国務院", "最高人民法院"], note: "P.8 全人代" },
            { category: "4. 法の支配と政治体制", question: "開発途上国で見られた、経済開発を優先して独裁を行う体制は？", answer: "開発独裁", options: ["開発独裁", "軍事政権", "ファシズム", "ポピュリズム"], note: "P.8" },
            { category: "4. 法の支配と政治体制", question: "イギリスの枢密院のような、国王の諮問機関的な役割を果たす機関は？", answer: "枢密院", options: ["枢密院", "貴族院", "庶民院", "内閣"], note: "P.8" },

            // --- 第1編 第3章 日本国憲法 (P9-P10) ---
            { category: "5. 日本国憲法", question: "大日本帝国憲法が発布された年月日は？", answer: "1889年2月11日", options: ["1889年2月11日", "1890年11月29日", "1946年11月3日", "1947年5月3日"], note: "P.9" },
            { category: "5. 日本国憲法", question: "大日本帝国憲法が施行された年月日は？", answer: "1890年11月29日", options: ["1890年11月29日", "1889年2月11日", "1947年5月3日", "1946年11月3日"], note: "P.9" },
            { category: "5. 日本国憲法", question: "大日本帝国憲法のように、君主が定めた憲法を何といいますか？", answer: "欽定憲法", options: ["欽定憲法", "民定憲法", "協約憲法", "不文憲法"], note: "P.9" },
            { category: "5. 日本国憲法", question: "大日本帝国憲法で見られた、立憲主義の形式をとりつつ実質は絶対主義的な体制は？", answer: "外見的立憲主義", options: ["外見的立憲主義", "真正立憲主義", "絶対君主制", "専制政治"], note: "P.9" },
            { category: "5. 日本国憲法", question: "大日本帝国憲法下で、天皇が軍隊を指揮監督する権限は？", answer: "統帥権", options: ["統帥権", "統治権", "立法権", "編成権"], note: "P.9" },
            { category: "5. 日本国憲法", question: "大日本帝国憲法下で、国務大臣が天皇を助けることを何といいますか？", answer: "輔弼", options: ["輔弼", "補佐", "代行", "助言"], note: "P.9" },
            { category: "5. 日本国憲法", question: "日本が受諾し、憲法改正のきっかけとなった宣言は？", answer: "ポツダム宣言", options: ["ポツダム宣言", "カイロ宣言", "サンフランシスコ平和条約", "大西洋憲章"], note: "P.9" },
            { category: "5. 日本国憲法", question: "GHQの正式名称は？", answer: "連合国軍総司令部", options: ["連合国軍総司令部", "国際連合", "極東委員会", "対日理事会"], note: "P.9" },
            { category: "5. 日本国憲法", question: "GHQが日本政府案（松本案）を拒否して提示した憲法草案は？", answer: "マッカーサー草案", options: ["マッカーサー草案", "松本案", "憲法研究会案", "吉田ドクトリン"], note: "P.9" },
            { category: "5. 日本国憲法", question: "日本国憲法の三大基本原理は、国民主権、基本的人権の尊重と何？", answer: "平和主義", options: ["平和主義", "天皇主権", "国家主権", "議会主権"], note: "P.9" },
            { category: "5. 日本国憲法", question: "日本国憲法において、天皇の地位は何と規定されていますか？", answer: "象徴", options: ["象徴", "元首", "主権者", "統治者"], note: "P.9" },
            { category: "5. 日本国憲法", question: "天皇が行う、政治的権限を持たない行為は？", answer: "国事行為", options: ["国事行為", "公的行為", "私的行為", "統治行為"], note: "P.9" },
            { category: "5. 日本国憲法", question: "国事行為を行う際に必要なものは、内閣の何と承認ですか？", answer: "助言", options: ["助言", "同意", "許可", "命令"], note: "P.9" },
            { category: "5. 日本国憲法", question: "国会は「国権の◯◯機関」とされています。", answer: "最高", options: ["最高", "唯一", "中心", "統括"], note: "P.10" },
            { category: "5. 日本国憲法", question: "憲法改正の発議に必要なのは、各議院の総議員のどれだけの賛成ですか？", answer: "3分の2以上", options: ["3分の2以上", "過半数", "3分の1以上", "4分の3以上"], note: "P.10" },
            { category: "5. 日本国憲法", question: "憲法改正の承認に必要なのは、国民投票でのどれだけの賛成ですか？", answer: "過半数", options: ["過半数", "3分の2以上", "3分の1以上", "全員"], note: "P.10" },
            { category: "5. 日本国憲法", question: "日本国憲法のように、改正手続きが法律よりも厳しい憲法は？", answer: "硬性憲法", options: ["硬性憲法", "軟性憲法", "不文憲法", "成文憲法"], note: "P.10" },
            { category: "5. 日本国憲法", question: "憲法第98条1項で、憲法は何であると定められていますか？", answer: "最高法規", options: ["最高法規", "基本法", "一般法", "特別法"], note: "P.10" },
            { category: "5. 日本国憲法", question: "憲法改正の国民投票権は何歳以上の国民に与えられますか？", answer: "18歳以上", options: ["18歳以上", "20歳以上", "25歳以上", "16歳以上"], note: "P.10" },

            // --- 第2編 第1章 私たちの生活と法 (P22) ---
            { category: "6. 法と社会", question: "社会の秩序を維持するためのルールを総称して何といいますか？", answer: "社会規範", options: ["社会規範", "法", "道徳", "慣習"], note: "P.22" },
            { category: "6. 法と社会", question: "人間の理性に基づき、時代や場所を超えて通用する法は？", answer: "自然法", options: ["自然法", "実定法", "制定法", "慣習法"], note: "P.22" },
            { category: "6. 法と社会", question: "一定の手続きを経て人為的に作られた法は？", answer: "実定法", options: ["実定法", "自然法", "道徳法", "宗教法"], note: "P.22" },
            { category: "6. 法と社会", question: "法の内容を評価する基準として、目的達成のために適切かどうかは？", answer: "手段の相当性", options: ["手段の相当性", "明確性", "公正性", "効率性"], note: "P.22" },
            { category: "6. 法と社会", question: "基本的人権は、憲法で「侵すことのできない◯◯の権利」とされています。", answer: "永久", options: ["永久", "絶対", "神聖", "固有"], note: "P.22" },
            { category: "6. 法と社会", question: "国家と国民の関係を規定した法（憲法や刑法など）は？", answer: "公法", options: ["公法", "私法", "社会法", "国際法"], note: "P.22" },
            { category: "6. 法と社会", question: "私人間の関係を規定した法（民法や商法など）は？", answer: "私法", options: ["私法", "公法", "社会法", "手続法"], note: "P.22" },
            { category: "6. 法と社会", question: "私人間では、契約などを自由に決められるという原則は？", answer: "私的自治の原則", options: ["私的自治の原則", "契約自由の原則", "過失責任の原則", "罪刑法定主義"], note: "P.22" },
            { category: "6. 法と社会", question: "三菱樹脂訴訟で最高裁が採用した、憲法の人権規定は私人間には直接適用されないとする説は？", answer: "間接適用説", options: ["間接適用説", "直接適用説", "無効説", "適用除外説"], note: "P.22" },
            { category: "6. 法と社会", question: "労働法や社会保障法のように、私法的な分野に国家が介入する法は？", answer: "社会法", options: ["社会法", "公法", "私法", "自然法"], note: "P.22" },
            { category: "6. 法と社会", question: "犯罪と刑罰はあらかじめ法律で定めなければならないという原則は？", answer: "罪刑法定主義", options: ["罪刑法定主義", "法の支配", "一事不再理", "遡及処罰の禁止"], note: "P.22" },
            { category: "6. 法と社会", question: "逮捕や捜索には、現行犯を除き裁判官の発する何が必要ですか？", answer: "令状", options: ["令状", "許可証", "命令書", "判決文"], note: "P.22 令状主義" },
            { category: "6. 法と社会", question: "人権相互の衝突を調整するための原理は？", answer: "公共の福祉", options: ["公共の福祉", "公序良俗", "信義誠実", "権利の濫用"], note: "P.22" },
            { category: "6. 法と社会", question: "刑事手続きにおいて、法の定める何によらなければ刑罰を科せられませんか？", answer: "適正手続き", options: ["適正手続き", "迅速手続き", "特別手続き", "略式手続き"], note: "P.22" },
            { category: "6. 法と社会", question: "国民の義務に含まれないものは？", answer: "投票の義務", options: ["投票の義務", "納税の義務", "勤労の義務", "教育を受けさせる義務"], note: "P.22" },

            // --- 第2編 第1章 自由・平等 (P23) ---
            { category: "7. 自由権と平等権", question: "個人の内面的な精神活動の自由を何といいますか？", answer: "内心の自由", options: ["内心の自由", "身体の自由", "経済的自由", "人身の自由"], note: "P.23" },
            { category: "7. 自由権と平等権", question: "国家が特定の宗教と結びついてはならないという原則は？", answer: "政教分離の原則", options: ["政教分離の原則", "信教の自由", "宗教的中立性", "世俗主義"], note: "P.23" },
            { category: "7. 自由権と平等権", question: "愛媛玉串料訴訟などで用いられた、行為の目的と効果から合憲性を判断する基準は？", answer: "目的効果基準", options: ["目的効果基準", "二重の基準", "明白かつ現在の危険", "LRAの基準"], note: "P.23" },
            { category: "7. 自由権と平等権", question: "精神的自由の規制は、経済的自由よりも厳格に審査すべきという考え方は？", answer: "二重の基準", options: ["二重の基準", "目的効果基準", "合理的配慮", "明白性の原則"], note: "P.23" },
            { category: "7. 自由権と平等権", question: "すべて国民は法の下に平等であり、人種、信条、社会的身分、または何により差別されない？", answer: "門地", options: ["門地", "能力", "学歴", "資産"], note: "P.23" },
            { category: "7. 自由権と平等権", question: "尊属殺人を重く罰する規定を違憲とした訴訟は？", answer: "尊属殺人重罰規定違憲訴訟", options: ["尊属殺人重罰規定違憲訴訟", "愛媛玉串料訴訟", "朝日訴訟", "堀木訴訟"], note: "P.23" },
            { category: "7. 自由権と平等権", question: "女性のみに課されていた再婚禁止期間（100日超の部分）を違憲とした訴訟は？", answer: "女性再婚禁止期間規定訴訟", options: ["女性再婚禁止期間規定訴訟", "非嫡出子相続分差別訴訟", "国籍法違憲訴訟", "夫婦別姓訴訟"], note: "P.23" },
            { category: "7. 自由権と平等権", question: "婚外子の相続分を婚内子の半分とする規定を違憲とした訴訟は？", answer: "非嫡出子相続分差別訴訟", options: ["非嫡出子相続分差別訴訟", "国籍法違憲訴訟", "尊属殺人訴訟", "再婚禁止訴訟"], note: "P.23" },
            { category: "7. 自由権と平等権", question: "アイヌ民族を初めて法律で「先住民族」と明記した法律は？", answer: "アイヌ施策推進法", options: ["アイヌ施策推進法", "アイヌ文化振興法", "北海道旧土人保護法", "人種差別撤廃法"], note: "P.23" },
            { category: "7. 自由権と平等権", question: "行政や企業に、障害者への「合理的配慮」を義務付けた法律は？", answer: "障害者差別解消法", options: ["障害者差別解消法", "障害者基本法", "バリアフリー法", "ハートビル法"], note: "P.23" },
            { category: "7. 自由権と平等権", question: "日本の国籍法が採用している、親の国籍で子の国籍が決まる原則は？", answer: "血統主義", options: ["血統主義", "出生地主義", "居住地主義", "二重国籍主義"], note: "P.23" },
            { category: "7. 自由権と平等権", question: "夫婦同姓の規定について、最高裁は合憲としましたか、違憲としましたか？", answer: "合憲", options: ["合憲", "違憲", "一部違憲", "判断留保"], note: "P.23" },
            { category: "7. 自由権と平等権", question: "経済的自由に含まれるのは、居住・移転、職業選択の自由と何？", answer: "財産権", options: ["財産権", "思想の自由", "学問の自由", "表現の自由"], note: "P.23" },

            // --- 第2編 第1章 社会権・新しい人権 (P24) ---
            { category: "8. 社会権と新しい人権", question: "国民が政治に参加する権利を総称して何といいますか？", answer: "参政権", options: ["参政権", "社会権", "自由権", "請求権"], note: "P.24" },
            { category: "8. 社会権と新しい人権", question: "最高裁裁判官を国民が辞めさせるかどうか決める制度は？", answer: "国民審査", options: ["国民審査", "国民投票", "弾劾裁判", "住民投票"], note: "P.24" },
            { category: "8. 社会権と新しい人権", question: "人権侵害の救済を求めたりするための権利（裁判を受ける権利など）は？", answer: "国務請求権", options: ["国務請求権", "社会権", "参政権", "自由権"], note: "P.24 請求権" },
            { category: "8. 社会権と新しい人権", question: "健康で文化的な最低限度の生活を営む権利は？", answer: "生存権", options: ["生存権", "幸福追求権", "環境権", "人格権"], note: "P.24" },
            { category: "8. 社会権と新しい人権", question: "生存権をめぐり、生活保護基準の合憲性が争われた訴訟は？", answer: "朝日訴訟", options: ["朝日訴訟", "堀木訴訟", "長沼ナイキ訴訟", "恵庭事件"], note: "P.24" },
            { category: "8. 社会権と新しい人権", question: "朝日訴訟で最高裁が示した、憲法25条は国の努力目標を定めたものだとする説は？", answer: "プログラム規定説", options: ["プログラム規定説", "法的権利説", "抽象的権利説", "具体的権利説"], note: "P.24" },
            { category: "8. 社会権と新しい人権", question: "労働三権とは、団結権、団体交渉権と何ですか？", answer: "団体行動権", options: ["団体行動権", "争議権", "労働権", "団結権"], note: "P.24 争議権" },
            { category: "8. 社会権と新しい人権", question: "大阪国際空港公害訴訟などで根拠とされた、静穏な環境を求める権利は？", answer: "環境権", options: ["環境権", "日照権", "人格権", "静穏権"], note: "P.24" },
            { category: "8. 社会権と新しい人権", question: "政府などの持つ情報の開示を求める権利は？", answer: "知る権利", options: ["知る権利", "アクセス権", "プライバシー権", "請求権"], note: "P.24" },
            { category: "8. 社会権と新しい人権", question: "マスメディアに対して反論記事の掲載などを求める権利は？", answer: "アクセス権", options: ["アクセス権", "知る権利", "報道の自由", "取材の自由"], note: "P.24 反論権" },
            { category: "8. 社会権と新しい人権", question: "自己に関する情報を自ら管理・コントロールする権利は？", answer: "プライバシーの権利", options: ["プライバシーの権利", "肖像権", "パブリシティ権", "忘れられる権利"], note: "P.24" },
            { category: "8. 社会権と新しい人権", question: "インターネット上の過去の不利益な情報の削除を求める権利は？", answer: "忘れられる権利", options: ["忘れられる権利", "知る権利", "アクセス権", "肖像権"], note: "P.24 EU等で保障" },
            { category: "8. 社会権と新しい人権", question: "医療現場などで、患者が十分な説明を受けた上で治療に同意することは？", answer: "インフォームド・コンセント", options: ["インフォームド・コンセント", "セカンド・オピニオン", "リビング・ウィル", "ターミナル・ケア"], note: "P.24" },
            { category: "8. 社会権と新しい人権", question: "防衛・外交などの秘密を保護し、漏洩を防止するための法律は？", answer: "特定秘密保護法", options: ["特定秘密保護法", "個人情報保護法", "通信傍受法", "マイナンバー法"], note: "P.24" },
            { category: "8. 社会権と新しい人権", question: "犯罪捜査のため、電話やFAXの傍受を認める法律は？", answer: "通信傍受法", options: ["通信傍受法", "特定秘密保護法", "個人情報保護法", "プロバイダ責任制限法"], note: "P.24" },
            { category: "8. 社会権と新しい人権", question: "在外日本人が国政選挙で投票できなかったことを違憲とした訴訟は？", answer: "在外日本人選挙権訴訟", options: ["在外日本人選挙権訴訟", "郵便法違憲訴訟", "議員定数不均衡訴訟", "自衛隊違憲訴訟"], note: "P.24" },

            // --- 第2編 第3章 環境問題 (P57, P71) ---
            { category: "9. 公害と環境問題", question: "経済活動によって第三者に意図せず不利益を与えることを何といいますか？", answer: "外部不経済", options: ["外部不経済", "市場の失敗", "フリーライダー", "モラルハザード"], note: "P.57" },
            { category: "9. 公害と環境問題", question: "公害対策基本法に代わり、1993年に制定された法律は？", answer: "環境基本法", options: ["環境基本法", "循環型社会形成推進基本法", "自然環境保全法", "公害防止条例"], note: "P.57" },
            { category: "9. 公害と環境問題", question: "公害において、企業に過失がなくても賠償責任を負わせる原則は？", answer: "無過失責任", options: ["無過失責任", "過失責任", "製造物責任", "危険責任"], note: "P.57" },
            { category: "9. 公害と環境問題", question: "公害防止費用は汚染者が負担すべきという原則（PPP）は？", answer: "汚染者負担の原則", options: ["汚染者負担の原則", "拡大生産者責任", "無過失責任", "予防原則"], note: "P.57" },
            { category: "9. 公害と環境問題", question: "大規模開発の前に、環境への影響を調査・評価することを何といいますか？", answer: "環境アセスメント", options: ["環境アセスメント", "環境モニタリング", "環境マネジメント", "コンプライアンス"], note: "P.57" },
            { category: "9. 公害と環境問題", question: "市民が募金などで土地を買い取り、自然を守る運動は？", answer: "ナショナル・トラスト", options: ["ナショナル・トラスト", "グリーン・ベルト", "エコツーリズム", "ビオトープ"], note: "P.57" },
            { category: "9. 公害と環境問題", question: "地球温暖化の原因となる二酸化炭素などのガスを総称して？", answer: "温室効果ガス", options: ["温室効果ガス", "フロンガス", "オゾン層", "PM2.5"], note: "P.71" },
            { category: "9. 公害と環境問題", question: "オゾン層を破壊する物質として規制されたガスは？", answer: "フロンガス", options: ["フロンガス", "メタンガス", "二酸化炭素", "亜硫酸ガス"], note: "P.71" },
            { category: "9. 公害と環境問題", question: "オゾン層保護のための条約（ウィーン条約）に基づき、具体的な規制を定めた議定書は？", answer: "モントリオール議定書", options: ["モントリオール議定書", "京都議定書", "名古屋議定書", "カルタヘナ議定書"], note: "P.71" },
            { category: "9. 公害と環境問題", question: "水鳥の生息地として重要な湿地を保護する条約は？", answer: "ラムサール条約", options: ["ラムサール条約", "ワシントン条約", "バーゼル条約", "ロンドン条約"], note: "P.71" },
            { category: "9. 公害と環境問題", question: "絶滅のおそれのある野生動植物の国際取引を規制する条約は？", answer: "ワシントン条約", options: ["ワシントン条約", "ラムサール条約", "ボン条約", "生物多様性条約"], note: "P.71" },
            { category: "9. 公害と環境問題", question: "1992年の地球サミット（リオデジャネイロ）で採択された宣言は？", answer: "リオ宣言", options: ["リオ宣言", "ストックホルム宣言", "ヨハネスブルク宣言", "パリ協定"], note: "P.71" },
            { category: "9. 公害と環境問題", question: "1997年に採択された、先進国の温室効果ガス削減目標を定めた議定書は？", answer: "京都議定書", options: ["京都議定書", "パリ協定", "モントリオール議定書", "コペンハーゲン合意"], note: "P.71" },
            { category: "9. 公害と環境問題", question: "京都議定書で導入された、排出枠の売買などを認める仕組みは？", answer: "京都メカニズム", options: ["京都メカニズム", "排出量取引", "クリーン開発メカニズム", "共同実施"], note: "P.71" },
            { category: "9. 公害と環境問題", question: "2015年に採択された、全ての国が参加する地球温暖化対策の枠組みは？", answer: "パリ協定", options: ["パリ協定", "京都議定書", "ドーハ改定", "カンクン合意"], note: "P.71" },
            { category: "9. 公害と環境問題", question: "酸性雨の主な原因物質は硫黄酸化物や何ですか？", answer: "窒素酸化物", options: ["窒素酸化物", "二酸化炭素", "フロン", "メタン"], note: "P.71" },
            { category: "9. 公害と環境問題", question: "酸性雨はpHがいくら以下の雨を指しますか？", answer: "5.6以下", options: ["5.6以下", "7.0以下", "4.0以下", "6.5以下"], note: "P.71" },
            { category: "9. 公害と環境問題", question: "砂漠化の防止のための支援を行う条約は？", answer: "砂漠化対処条約", options: ["砂漠化対処条約", "気候変動枠組条約", "生物多様性条約", "バーゼル条約"], note: "P.71" },
            { category: "9. 公害と環境問題", question: "有害廃棄物の国境を越える移動を規制する条約は？", answer: "バーゼル条約", options: ["バーゼル条約", "ロンドン条約", "ロッテルダム条約", "ストックホルム条約"], note: "P.71 Check File" },

            // --- 第2編 第3章 資源・エネルギー (P72) ---
            { category: "10. 資源・エネルギー", question: "確認埋蔵量を年間生産量で割った指標は？", answer: "可採年数", options: ["可採年数", "耐用年数", "埋蔵寿命", "資源限界"], note: "P.72" },
            { category: "10. 資源・エネルギー", question: "エネルギー源の中心が石炭から石油へ転換したことは？", answer: "エネルギー革命", options: ["エネルギー革命", "産業革命", "緑の革命", "IT革命"], note: "P.72" },
            { category: "10. 資源・エネルギー", question: "アメリカなどで生産が増加した、新しい天然ガス資源は？", answer: "シェールガス", options: ["シェールガス", "メタンハイドレート", "オイルサンド", "バイオガス"], note: "P.72" },
            { category: "10. 資源・エネルギー", question: "ハイテク製品に不可欠な希少金属を何といいますか？", answer: "レアメタル", options: ["レアメタル", "レアアース", "ベースメタル", "プレシャスメタル"], note: "P.72" },
            { category: "10. 資源・エネルギー", question: "輸入食料を生産するのに必要な水の量を推定した概念は？", answer: "バーチャルウォーター", options: ["バーチャルウォーター", "ウォーターフットプリント", "フードマイレージ", "エコロジカル・リュックサック"], note: "P.72 仮想水" },
            { category: "10. 資源・エネルギー", question: "再生可能エネルギーの固定価格買取制度の略称は？", answer: "FIT", options: ["FIT", "RPS", "COP", "GDP"], note: "P.72" },
            { category: "10. 資源・エネルギー", question: "発電時の排熱を給湯などに利用するシステムは？", answer: "コージェネレーション", options: ["コージェネレーション", "ヒートポンプ", "コンバインドサイクル", "スマートグリッド"], note: "P.72" },
            { category: "10. 資源・エネルギー", question: "IT技術を活用して電力需給を最適化する次世代送電網は？", answer: "スマートグリッド", options: ["スマートグリッド", "スマートシティ", "マイクログリッド", "パワーグリッド"], note: "P.72" },
            { category: "10. 資源・エネルギー", question: "3Rの中で最も優先順位が高いとされるのは？", answer: "リデュース", options: ["リデュース", "リユース", "リサイクル", "熱回収"], note: "P.72" },
            { category: "10. 資源・エネルギー", question: "国などが率先して環境負荷の少ない製品を購入する法律は？", answer: "グリーン購入法", options: ["グリーン購入法", "リサイクル法", "環境基本法", "省エネ法"], note: "P.72" },
            { category: "10. 資源・エネルギー", question: "循環型社会形成推進基本法で定められた社会を何といいますか？", answer: "循環型社会", options: ["循環型社会", "低炭素社会", "持続可能な社会", "共生社会"], note: "P.72" },

            // --- 第2編 第3章 国際社会 (P73) ---
            { category: "11. 国際社会の課題", question: "発展途上国などで人口が急激に増加する現象は？", answer: "人口爆発", options: ["人口爆発", "人口オーナス", "ベビーブーム", "ドーナツ化現象"], note: "P.73" },
            { category: "11. 国際社会の課題", question: "UNDPが発表している、豊かさの指標（HDI）の日本語名は？", answer: "人間開発指数", options: ["人間開発指数", "国民総幸福量", "ジェンダー指数", "貧困指数"], note: "P.73" },
            { category: "11. 国際社会の課題", question: "性と生殖に関する健康・権利をカタカナで？", answer: "リプロダクティブ・ヘルス/ライツ", options: ["リプロダクティブ・ヘルス/ライツ", "エンパワーメント", "ジェンダー・フリー", "ノーマライゼーション"], note: "P.73" },
            { category: "11. 国際社会の課題", question: "先進国を中心とする「経済協力開発機構」の略称は？", answer: "OECD", options: ["OECD", "WTO", "IMF", "WHO"], note: "P.73" },
            { category: "11. 国際社会の課題", question: "貧困や環境破壊などから個人を守るという考え方を何といいますか？", answer: "人間の安全保障", options: ["人間の安全保障", "国家の安全保障", "集団安全保障", "経済安全保障"], note: "P.73" },
            { category: "11. 国際社会の課題", question: "2015年に国連で採択された「持続可能な開発目標」の略称は？", answer: "SDGs", options: ["SDGs", "MDGs", "ODA", "NGO"], note: "P.73" },
            { category: "11. 国際社会の課題", question: "国連食糧農業機関の略称は？", answer: "FAO", options: ["FAO", "WFP", "WHO", "WTO"], note: "P.73" },
            { category: "11. 国際社会の課題", question: "国連世界食糧計画の略称は？", answer: "WFP", options: ["WFP", "FAO", "UNICEF", "UNHCR"], note: "P.73" },
            { category: "11. 国際社会の課題", question: "1996年の世界食料サミットで採択された宣言は？", answer: "ローマ宣言", options: ["ローマ宣言", "リオ宣言", "ミレニアム宣言", "カイロ宣言"], note: "P.73" },
            { category: "11. 国際社会の課題", question: "国連人口基金の略称は？", answer: "UNFPA", options: ["UNFPA", "UNDP", "UNEP", "UNICEF"], note: "P.73" }
        ];

        // シャッフル関数
        const shuffleArray = (array) => {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        };

        const QuizApp = () => {
            const [gameState, setGameState] = useState('menu'); // menu, playing, result
            const [questions, setQuestions] = useState([]);
            const [currentIndex, setCurrentIndex] = useState(0);
            const [score, setScore] = useState(0);
            const [showAnswer, setShowAnswer] = useState(false);
            const [userSelected, setUserSelected] = useState(null);
            const [mode, setMode] = useState(null); // 'normal', 'survival', 'review'
            const [category, setCategory] = useState('ALL');
            
            // 履歴保存用
            const [history, setHistory] = useState({ completed: [], wrong: [] });

            useEffect(() => {
                const saved = localStorage.getItem('civics_history_v4');
                if (saved) setHistory(JSON.parse(saved));
            }, []);

            const saveHistory = (q, isCorrect) => {
                const newHistory = { ...history };
                if (isCorrect) {
                    if (!newHistory.completed.includes(q.question)) {
                        newHistory.completed.push(q.question);
                    }
                    newHistory.wrong = newHistory.wrong.filter(w => w !== q.question);
                } else {
                    if (!newHistory.wrong.includes(q.question)) {
                        newHistory.wrong.push(q.question);
                    }
                }
                setHistory(newHistory);
                localStorage.setItem('civics_history_v4', JSON.stringify(newHistory));
            };

            const startQuiz = (selectedMode, selectedCategory = 'ALL') => {
                let qs = [];
                if (selectedMode === 'review') {
                    qs = quizDatabase.filter(q => history.wrong.includes(q.question));
                } else if (selectedCategory === 'ALL') {
                    qs = [...quizDatabase];
                } else {
                    qs = quizDatabase.filter(q => q.category === selectedCategory);
                }

                if (qs.length === 0) {
                    alert("問題がありません！");
                    return;
                }

                // シャッフル
                qs = shuffleArray(qs).map(q => ({
                    ...q,
                    shuffledOptions: shuffleArray(q.options)
                }));

                setQuestions(qs);
                setCurrentIndex(0);
                setScore(0);
                setShowAnswer(false);
                setUserSelected(null);
                setMode(selectedMode);
                setCategory(selectedCategory);
                setGameState('playing');
            };

            const handleAnswer = (option) => {
                const currentQ = questions[currentIndex];
                const isCorrect = option === currentQ.answer;
                setUserSelected(option);
                setShowAnswer(true);
                
                if (isCorrect) {
                    setScore(s => s + 1);
                    saveHistory(currentQ, true);
                } else {
                    saveHistory(currentQ, false);
                    if (mode === 'survival') {
                        setTimeout(() => setGameState('result'), 1500); // サバイバルは即終了
                        return;
                    }
                }
            };

            const nextQuestion = () => {
                if (currentIndex < questions.length - 1) {
                    setCurrentIndex(i => i + 1);
                    setShowAnswer(false);
                    setUserSelected(null);
                } else {
                    setGameState('result');
                }
            };

            const categories = useMemo(() => [...new Set(quizDatabase.map(q => q.category))], []);
            const progress = Math.round((history.completed.length / quizDatabase.length) * 100);

            // --- Menu Screen ---
            if (gameState === 'menu') {
                return (
                    <div className="min-h-screen bg-bg pb-10 font-sans">
                        <header className="bg-white/80 backdrop-blur sticky top-0 z-10 border-b border-gray-200 px-6 py-4 flex justify-between items-center">
                            <h1 className="text-xl font-black text-primaryDark tracking-tight">公共・政経 極</h1>
                            <div className="text-xs font-bold text-gray-500 bg-gray-100 px-3 py-1 rounded-full">
                                制覇率 {progress}%
                            </div>
                        </header>
                        
                        <div className="max-w-2xl mx-auto px-4 pt-8 space-y-8 fade-in">
                            {/* メインカード */}
                            <div className="bg-gradient-to-br from-primary to-primaryDark rounded-3xl p-8 text-white shadow-xl shadow-indigo-200 relative overflow-hidden">
                                <div className="relative z-10">
                                    <div className="text-indigo-200 text-sm font-bold mb-1 tracking-wider uppercase">Total Questions</div>
                                    <div className="text-5xl font-black mb-6">{quizDatabase.length}<span className="text-2xl ml-1">問</span></div>
                                    <div className="flex gap-3">
                                        <button onClick={() => startQuiz('normal', 'ALL')} className="flex-1 bg-white text-primaryDark py-3 rounded-xl font-bold shadow-lg hover:bg-gray-50 active:scale-95 transition">
                                            全問挑戦
                                        </button>
                                        <button onClick={() => startQuiz('survival', 'ALL')} className="flex-1 bg-danger text-white py-3 rounded-xl font-bold shadow-lg border-2 border-white/20 hover:bg-red-600 active:scale-95 transition flex flex-col items-center justify-center leading-none">
                                            <span>サバイバル</span>
                                            <span className="text-[10px] opacity-80 mt-1">1ミス終了</span>
                                        </button>
                                    </div>
                                </div>
                                <div className="absolute -right-10 -bottom-20 w-64 h-64 bg-white/10 rounded-full blur-3xl"></div>
                            </div>

                            {/* 弱点克服 */}
                            {history.wrong.length > 0 && (
                                <button onClick={() => startQuiz('review')} className="w-full bg-white border-l-4 border-danger p-4 rounded-xl shadow-sm flex items-center justify-between hover:shadow-md transition group">
                                    <div>
                                        <div className="font-bold text-gray-800 group-hover:text-danger transition">弱点克服モード</div>
                                        <div className="text-xs text-gray-400">{history.wrong.length}問のミスがあります</div>
                                    </div>
                                    <div className="w-8 h-8 rounded-full bg-red-50 flex items-center justify-center text-danger">
                                        <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clipRule="evenodd" /></svg>
                                    </div>
                                </button>
                            )}

                            {/* カテゴリリスト */}
                            <div className="space-y-3">
                                <h2 className="text-gray-400 text-xs font-bold uppercase tracking-widest ml-1">Categories</h2>
                                {categories.map((cat, i) => (
                                    <button key={i} onClick={() => startQuiz('normal', cat)} className="w-full bg-white p-5 rounded-2xl shadow-sm border border-gray-100 flex items-center justify-between hover:border-primary/30 hover:shadow-md transition active:scale-[0.99] text-left">
                                        <div>
                                            <div className="font-bold text-gray-700 text-sm md:text-base">{cat}</div>
                                            <div className="text-xs text-gray-400 mt-1">{quizDatabase.filter(q => q.category === cat).length} Questions</div>
                                        </div>
                                        <div className="w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center text-gray-300">
                                            <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clipRule="evenodd" /></svg>
                                        </div>
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            // --- Playing Screen ---
            const currentQ = questions[currentIndex];
            const isLast = currentIndex === questions.length - 1;
            
            if (gameState === 'playing') {
                return (
                    <div className="h-screen bg-bg flex flex-col font-sans overflow-hidden relative">
                        {/* モード表示 */}
                        {mode === 'survival' && (
                            <div className="bg-danger text-white text-xs font-bold text-center py-1 absolute top-0 w-full z-30">
                                SURVIVAL MODE - 1ミスで即終了
                            </div>
                        )}

                        {/* ヘッダー */}
                        <div className="px-6 py-4 flex justify-between items-end bg-white border-b border-gray-100 z-20 mt-4">
                            <div>
                                <div className="text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1">{category}</div>
                                <div className="flex items-baseline gap-1">
                                    <span className="text-2xl font-black text-gray-800">Q.{currentIndex + 1}</span>
                                    <span className="text-xs text-gray-400 font-bold">/ {questions.length}</span>
                                </div>
                            </div>
                            <button onClick={() => setGameState('menu')} className="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 hover:bg-gray-200 transition">
                                <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clipRule="evenodd" /></svg>
                            </button>
                        </div>

                        {/* プログレスバー */}
                        <div className="w-full bg-gray-200 h-1">
                            <div className="bg-primary h-full transition-all duration-300" style={{ width: `${((currentIndex) / questions.length) * 100}%` }}></div>
                        </div>

                        {/* コンテンツ */}
                        <div className="flex-1 overflow-y-auto p-6 pb-32 max-w-2xl mx-auto w-full">
                            <div className="bg-white p-8 rounded-3xl shadow-sm border border-gray-100 mb-8 slide-up">
                                <h2 className="text-xl font-bold text-gray-800 leading-relaxed">{currentQ.question}</h2>
                                <div className="mt-4 flex justify-end">
                                    <span className="text-[10px] font-bold text-gray-400 bg-gray-50 px-2 py-1 rounded border border-gray-100">NOTE: {currentQ.note}</span>
                                </div>
                            </div>

                            <div className="space-y-3">
                                {currentQ.shuffledOptions.map((option, idx) => {
                                    let stateClass = "bg-white border-transparent text-gray-600 shadow-sm hover:bg-gray-50 hover:border-gray-200";
                                    if (showAnswer) {
                                        if (option === currentQ.answer) {
                                            stateClass = "bg-secondary/10 border-secondary text-secondary font-bold ring-1 ring-secondary";
                                        } else if (option === userSelected) {
                                            stateClass = "bg-danger/10 border-danger text-danger font-bold";
                                        } else {
                                            stateClass = "opacity-40 grayscale";
                                        }
                                    }

                                    return (
                                        <button
                                            key={idx}
                                            onClick={() => !showAnswer && handleAnswer(option)}
                                            disabled={showAnswer}
                                            className={`w-full p-5 rounded-2xl text-left text-sm md:text-base transition-all duration-200 border-2 relative ${stateClass} ${!showAnswer ? 'active:scale-[0.98]' : ''}`}
                                        >
                                            <div className="flex items-center gap-4">
                                                <div className={`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold border ${
                                                    showAnswer && option === currentQ.answer ? 'bg-secondary text-white border-secondary' :
                                                    showAnswer && option === userSelected ? 'bg-danger text-white border-danger' :
                                                    'bg-gray-100 text-gray-400 border-gray-200'
                                                }`}>
                                                    {['A','B','C','D'][idx]}
                                                </div>
                                                <span>{option}</span>
                                            </div>
                                        </button>
                                    );
                                })}
                            </div>
                        </div>

                        {/* 結果表示バー */}
                        {showAnswer && (
                            <div className={`fixed bottom-0 w-full p-4 z-30 fade-in ${mode === 'survival' && userSelected !== currentQ.answer ? 'bg-danger' : 'bg-white border-t border-gray-200'}`}>
                                <div className="max-w-2xl mx-auto flex items-center justify-between">
                                    <div className={mode === 'survival' && userSelected !== currentQ.answer ? 'text-white' : ''}>
                                        <div className="text-[10px] font-bold opacity-60 uppercase mb-1">ANSWER</div>
                                        <div className="text-lg font-black leading-none">{currentQ.answer}</div>
                                    </div>
                                    {!(mode === 'survival' && userSelected !== currentQ.answer) && (
                                        <button onClick={nextQuestion} className="bg-primary text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-indigo-200 hover:bg-primaryDark transition active:scale-95 flex items-center gap-2">
                                            <span>{isLast ? '結果を見る' : '次へ'}</span>
                                            <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clipRule="evenodd" /></svg>
                                        </button>
                                    )}
                                </div>
                            </div>
                        )}
                    </div>
                );
            }

            // --- Result Screen ---
            if (gameState === 'result') {
                const percent = Math.round((score / (mode === 'survival' ? currentIndex + 1 : questions.length)) * 100);
                return (
                    <div className="min-h-screen bg-bg flex items-center justify-center p-6 font-sans">
                        <div className="bg-white p-10 rounded-3xl shadow-xl w-full max-w-md text-center pop-in relative overflow-hidden">
                            <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-secondary to-primary"></div>
                            
                            <h2 className="text-gray-400 text-xs font-bold tracking-widest uppercase mb-8">{mode === 'survival' ? 'SURVIVAL RESULT' : 'RESULT'}</h2>
                            
                            <div className="text-6xl font-black text-gray-800 mb-2">{score}</div>
                            <div className="text-gray-400 font-bold text-sm mb-8">
                                {mode === 'survival' ? 'Questions Survived' : `/ ${questions.length} Correct`}
                            </div>

                            {mode === 'survival' ? (
                                <p className="text-lg font-bold text-gray-600 mb-8">
                                    {score > 20 ? "素晴らしい集中力！神レベル！🏆" : score > 10 ? "ナイスファイト！次はもっといける！🔥" : "ドンマイ！再挑戦だ！💪"}
                                </p>
                            ) : (
                                <p className="text-lg font-bold text-gray-600 mb-8">
                                    {percent === 100 ? "完全制覇おめでとうございます！🎉" : percent >= 80 ? "合格点です！その調子！✨" : "復習して完璧を目指しましょう！📚"}
                                </p>
                            )}

                            <div className="space-y-3">
                                <button onClick={() => startQuiz(mode, category)} className="w-full bg-primary text-white py-4 rounded-xl font-bold shadow-lg shadow-indigo-100 hover:bg-primaryDark transition active:scale-95">
                                    もう一度挑戦
                                </button>
                                <button onClick={() => setGameState('menu')} className="w-full bg-white text-gray-500 py-4 rounded-xl font-bold border border-gray-200 hover:bg-gray-50 transition active:scale-95">
                                    メニューへ
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }
            return null;
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<QuizApp />);
    </script>
</body>
</html>
```
```